(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/goods_order_detail/goods_order_detail"],{3641:function(t,e,o){},4919:function(t,e,o){"use strict";o.d(e,"b",(function(){return s})),o.d(e,"c",(function(){return i})),o.d(e,"a",(function(){return n}));var n={uniTable:function(){return o.e("uni_modules/uni-table/components/uni-table/uni-table").then(o.bind(null,"14c9"))},uniTr:function(){return o.e("uni_modules/uni-table/components/uni-tr/uni-tr").then(o.bind(null,"b012"))},uniTh:function(){return o.e("uni_modules/uni-table/components/uni-th/uni-th").then(o.bind(null,"5fba"))},uniTd:function(){return o.e("uni_modules/uni-table/components/uni-td/uni-td").then(o.bind(null,"4143"))}},s=function(){var t=this.$createElement;this._self._c},i=[]},a206:function(t,e,o){"use strict";(function(t,e){var n=o("4ea4");o("7711");n(o("66fd"));var s=n(o("c8c2"));t.__webpack_require_UNI_MP_PLUGIN__=o,e(s.default)}).call(this,o("bc2e")["default"],o("543d")["createPage"])},b1ed:function(t,e,o){"use strict";o.r(e);var n=o("bf48"),s=o.n(n);for(var i in n)["default"].indexOf(i)<0&&function(t){o.d(e,t,(function(){return n[t]}))}(i);e["default"]=s.a},bd83:function(t,e,o){"use strict";var n=o("3641"),s=o.n(n);s.a},bf48:function(t,e,o){"use strict";(function(t){var n=o("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=n(o("2eee")),i=n(o("c973")),r=n(o("9523")),a=o("26cb");function c(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function d(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?c(Object(o),!0).forEach((function(e){(0,r.default)(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):c(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var u={data:function(){return{goods_count:1,goods_info:{},spdm:"",buttonGroup:[{text:"下一步",backgroundColor:"#ff0000",color:"#fff"}],defaultPic:"https://img3.doubanio.com/f/movie/8dd0c794499fe925ae2ae89ee30cd225750457b4/pics/movie/celebrity-default-medium.png",spjg:"",imgurl:"http://images.yndzyf.com/getimage.ashx?mlszh=",imgList:[],bimgList:[],isRx:""}},onLoad:function(e){this.spdm=e.spdm,this.getGoodsDetail(this.reobj),t.setStorageSync("pagelx","下订单")},filters:{tofixed:function(t){return 0==t?" ":Number(t).toFixed(2)}},methods:d(d({},(0,a.mapMutations)("m_cart",["addToCart"])),{},{getGoodsDetail:function(e){var o=this;return(0,i.default)(s.default.mark((function e(){return s.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.request({url:"https://appletservice.dyb.yn.cn/api/SearchSpmlDetail",method:"POST",header:{"Content-Type":"application/json","X-Ca-Key":"wxe7c826a1a5e00055","X-Service-Method":"SearchSpmlDetail"},data:{spdm:o.spdm},success:function(t){-99!=t.data.result&&(console.log(t.data.data),o.goods_info=t.data.data,"处方药须凭处方在药师指导下购买和使用!"===o.goods_info[0].tssm1?o.isRx="true":o.isRx="false")}});case 1:case"end":return e.stop()}}),e)})))()},numFilter:function(t){var e=parseFloat(t).toFixed(2);return e},preview:function(e,o){if("处方药须凭处方在药师指导下购买和使用!"!==o){this.getImgList();var n=new Set(this.imgList);this.imgList=Array.from(n),t.previewImage({current:this.imgurl+this.goods_info[0].spml_tpxx_lb[e].tplszh,urls:this.imgList})}},numChangeHandler:function(t){this.goods_count=t},bpreview:function(e,o){if("处方药须凭处方在药师指导下购买和使用!"!==o){this.getbImgList();var n=new Set(this.bimgList);this.bimgList=Array.from(n),t.previewImage({current:this.imgurl+this.goods_info[0].spml_tpxx[e].tplszh,urls:this.bimgList})}},getImgList:function(){for(var t=0;t<this.goods_info[0].spml_tpxx_lb.length;t++)this.imgList.push(this.imgurl+this.goods_info[0].spml_tpxx_lb[t].tplszh);console.log(this.imgList)},getbImgList:function(){for(var t=0;t<this.goods_info[0].spml_tpxx.length;t++)this.bimgList.push(this.imgurl+this.goods_info[0].spml_tpxx[t].tplszh);console.log(this.bimgList)},settlement:function(){var e=this;return(0,i.default)(s.default.mark((function o(){var n,i;return s.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(n=e,t.getStorageSync("userInfo")){o.next=3;break}return o.abrupt("return",e.delayNavigate());case 3:t.getStorageSync("mdId")||(t.getStorageSync("wd")?(t.getLocation({type:"gcj02",success:function(e){console.log(e),t.setStorageSync("wd",e.latitude),t.setStorageSync("jd",e.longitude)}}),t.showLoading({title:"获取门店信息中"}),i={spdm:e.goods_info[0].spdm,pm:e.goods_info[0].pm,spgg:e.goods_info[0].spgg,dqlsj:e.goods_info[0].dqlsj,sccs:e.goods_info[0].sccs,tsbz:e.goods_info[0].tsbz,spml_tpxx_lb:[{tplszh:e.goods_info[0].spml_tpxx_lb[0].tplszh},{tplszh:e.goods_info[0].spml_tpxx_lb[0].tplszh}],goods_count:1,goods_state:!0},t.removeStorageSync("cart"),t.setStorageSync("cart",JSON.stringify(i)),t.request({url:"https://appletservice.dyb.yn.cn/api/CheckMdkc",header:{"Content-Type":"application/json","X-Ca-Key":"wxe7c826a1a5e00055","X-Service-Method":"CheckMdkc"},method:"POST",data:{spxx_json:i,wd:t.getStorageSync("wd"),jd:t.getStorageSync("jd")},success:function(o){console.log(i),console.log(o),e.mdxx=o.data.data,null===e.mdxx?(console.log("无门店"),t.navigateTo({url:"/pages/goods_order_warning_shop/goods_order_warning_shop"})):t.setStorage({key:"mdxx",data:e.mdxx,success:function(){t.navigateTo({url:"/pages/goods_order_address_select/goods_order_address_select?isRx="+n.isRx})}})},fail:function(e){console.log("出错了"),console.log(e),t.hideLoading()}})):t.navigateTo({url:"/pages/goods_order_location/goods_order_location"})),t.getStorageSync("mdId")&&(n=e,e.newCart=JSON.parse(t.getStorageSync("cart")),e.newCart=e.newCart.filter((function(t){return t.goods_state})),console.log(e.newCart),t.request({url:"https://appletservice.dyb.yn.cn/api/InsertXqqd",method:"POST",header:{"Content-Type":"application/json","X-Ca-Key":"wxe7c826a1a5e00055","X-Service-Method":"InsertXqqd"},data:{openid:t.getStorageSync("openid"),lxdh:t.getStorageSync("lxdh"),mddm:t.getStorageSync("mdId"),spxx_json:n.newCart},success:function(e){t.setStorageSync("mdId",""),t.showModal({title:"提交需求成功！",content:"请保持电话畅通，稍后会有客服与您联系！",showCancel:!1,success:function(t){t.confirm?n.removeGoodsByIsCheck(n.datac):t.cancel&&console.log("用户点击取消")}})},fail:function(t){console.log("出错了"),console.log(t)}}));case 5:case"end":return o.stop()}}),o)})))()},delayNavigate:function(){var e=this;this.seconds=3,this.showTips(this.seconds),this.timer=setInterval((function(){if(e.seconds--,e.seconds<=0)return clearInterval(e.timer),void t.navigateTo({url:"/pages/login/login"});e.showTips(e.seconds)}),1e3)},showTips:function(e){t.showToast({icon:"none",title:"请授权后再点击下一步！"+e+"秒之后自动跳转到授权页",mask:!0,duration:1500})}})};e.default=u}).call(this,o("543d")["default"])},c8c2:function(t,e,o){"use strict";o.r(e);var n=o("4919"),s=o("b1ed");for(var i in s)["default"].indexOf(i)<0&&function(t){o.d(e,t,(function(){return s[t]}))}(i);o("bd83");var r=o("f0c5"),a=Object(r["a"])(s["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);e["default"]=a.exports}},[["a206","common/runtime","common/vendor"]]]);
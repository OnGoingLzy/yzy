(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/order/order_card"],{"227c":function(e,t,o){},"582b":function(e,t,o){"use strict";o.r(t);var n=o("f523"),r=o.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){o.d(t,e,(function(){return n[e]}))}(a);t["default"]=r.a},"5ab5":function(e,t,o){"use strict";var n=o("227c"),r=o.n(n);r.a},6254:function(e,t,o){"use strict";o.d(t,"b",(function(){return r})),o.d(t,"c",(function(){return a})),o.d(t,"a",(function(){return n}));var n={uniPopup:function(){return o.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(o.bind(null,"0336"))},uniDataSelect:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uni-data-select/components/uni-data-select/uni-data-select")]).then(o.bind(null,"9916"))}},r=function(){var e=this.$createElement;this._self._c},a=[]},decb:function(e,t,o){"use strict";o.r(t);var n=o("6254"),r=o("582b");for(var a in r)["default"].indexOf(a)<0&&function(e){o.d(t,e,(function(){return r[e]}))}(a);o("5ab5");var i=o("f0c5"),s=Object(i["a"])(r["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);t["default"]=s.exports},f523:function(e,t,o){"use strict";(function(e){var n=o("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(o("2eee")),a=n(o("c973")),i=n(o("24db")),s=n(o("ae48")),c={props:{order:{default:null}},data:function(){return{checkboxValue:0,checkboxRange:[{value:0,text:"请选择"}],showMore:!1,orderInfo:{shop:{shopId:1,shopName:"测试店铺"},goods:[{goodsName:"测试药品1",price:16.8,goodsImg:"/static/icon/shop.svg",description:"20mgx6粒/瓶",num:1},{goodsName:"测试药品2",price:16.8,goodsImg:"/static/icon/shop.svg",description:"20mgx6粒/瓶",num:1}],order:{orderNo:"202308031154",orderStatus:"待付款"},allPrice:30,fee:0,discounts:3.6},totalPrice:0,totalNum:0,shippingFee:0,defaultPic:"http://images.yndzyf.com/getimage.ashx?mlszh=17700932",imgurl:"http://images.yndzyf.com/getimage.ashx?mlszh=",isEnableClick:!0,textareaContent:""}},mounted:function(){},methods:{toPurchasedGoodsDetails:function(t){e.navigateTo({url:"/pages/purchased_goods_details/purchased_goods_details?goods="+encodeURIComponent(JSON.stringify(t))})},toShop:function(){e.navigateTo({url:"/pages/shop_certificate/shop_certificate?shopName="+encodeURIComponent(JSON.stringify(this.order.shopInfo[0].shopName))+"&shopId="+encodeURIComponent(JSON.stringify(this.order.shopInfo[0].shopId))})},showImg:function(t){e.previewImage({urls:[t],longPressActions:{itemList:["发送给朋友","保存图片","收藏"],success:function(e){},fail:function(e){console.log(e.errMsg)}}})},getRefundReason:function(){var t=this;return(0,a.default)(r.default.mark((function o(){var n,a;return r.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return"/api/User/getRefundReason","POST",n={openid:e.getStorageSync("openid")},o.prev=3,o.next=6,(0,i.default)("yzy_app","/api/User/getRefundReason","POST",n);case 6:a=o.sent,console.log(a),99==a.code?t.checkboxRange=JSON.parse(a.data):e.showToast({icon:"error",title:a.msg,duration:3e3}),o.next=14;break;case 11:o.prev=11,o.t0=o["catch"](3),e.showToast({icon:"error",title:o.t0,duration:3e3});case 14:case"end":return o.stop()}}),o,null,[[3,11]])})))()},callPhone:function(t){var o=t.match(/\d+-?\d+/g);if(o&&o.length>0){var n=o[0];console.log("提取到的电话号码："+n),e.makePhoneCall({phoneNumber:n})}else console.log("未找到电话号码")},clickShowMore:function(){this.showMore=!this.showMore},confirmReceived:function(){console.log(this.order.main_order_id);var t=this;e.showModal({title:"确认收货",content:"您确定即将对该笔订单进行确认收货吗？",success:function(e){if(e.confirm)t.uploadConfirmMsg(t.order.main_order_id);else if(e.cancel)return}})},uploadConfirmMsg:function(t){var o=this;return(0,a.default)(r.default.mark((function n(){var a,s,c;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return"/api/User/uploadConfirmReceived","POST",a={tradeNo:t,confirmType:"客户确认"},n.prev=3,n.next=6,(0,i.default)("yzy_app","/api/User/uploadConfirmReceived","POST",a);case 6:s=n.sent,console.log(s),99==s.code?(c=JSON.parse(s.data),o.uploadConfirmMsgToZhyf(t,c.operateId,c.receiveConfirmTime)):e.showToast({icon:"error",title:"确认收货失败",duration:3e3}),n.next=14;break;case 11:n.prev=11,n.t0=n["catch"](3),e.showToast({icon:"error",title:n.t0,duration:3e3});case 14:case"end":return n.stop()}}),n,null,[[3,11]])})))()},uploadConfirmMsgToZhyf:function(t,o,n){var i=this;return(0,a.default)(r.default.mark((function a(){var c,u,d;return r.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return"/api/Zhyf/getOuterOrderReceived","POST",c={tradeNo:t,confirmType:"客户确认",confirmTime:n,operateId:o},u=JSON.stringify(c),r.prev=4,r.next=7,(0,s.default)("yzy_app","/api/Zhyf/getOuterOrderReceived","POST",u);case 7:d=r.sent,console.log(d),99==d.code?(e.showToast({icon:"success",title:"确认收货成功",duration:3e3}),i.$emit("childMethod")):e.showToast({icon:"error",title:"确认收货失败",duration:3e3}),r.next=15;break;case 12:r.prev=12,r.t0=r["catch"](4),e.showToast({icon:"error",title:r.t0,duration:3e3});case 15:case"end":return r.stop()}}),a,null,[[4,12]])})))()},refund:function(){console.log(this.order.main_order_id);this.$refs.popup.open("center"),this.getRefundReason()},refundCancel:function(){this.$refs.popup.close(),this.textareaContent="",this.checkboxValue=0},refundConfirm:function(){var t=this;if(0!==this.checkboxValue){e.showLoading({title:"请稍等...",mask:!0});var o=this.checkboxRange.find((function(e){return e.value===t.checkboxValue})),n=o?o.text:"",r=n+"："+this.textareaContent;console.log(r),this.applyReturned(this.order.main_order_id,r)}else e.showToast({icon:"error",title:"请选择退货原因",duration:3e3})},applyReturned:function(t,o){var n=this;return(0,a.default)(r.default.mark((function a(){var s,c,u;return r.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return"/api/User/applyReturned","POST",s={orign_main_order_id:t,reasonOfReturn:o},r.prev=3,r.next=6,(0,i.default)("yzy_app","/api/User/applyReturned","POST",s);case 6:c=r.sent,console.log(c),99==c.code?(u=JSON.parse(c.data),n.getJsonZhyfOrderReturned(u.main_order_id,u.operateId)):(e.hideLoading(),e.showToast({icon:"error",title:"申请退款失败,"+c.msg,duration:3e3}),n.$refs.popup.close(),n.checkboxValue=0,n.$emit("childMethod")),r.next=14;break;case 11:r.prev=11,r.t0=r["catch"](3),e.showToast({icon:"error",title:r.t0,duration:3e3});case 14:case"end":return r.stop()}}),a,null,[[3,11]])})))()},getJsonZhyfOrderReturned:function(t,o){var n=this;return(0,a.default)(r.default.mark((function a(){var s,c;return r.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return"/api/User/getJsonZhyfOrderReturned","POST",s={main_order_id:t},r.prev=3,r.next=6,(0,i.default)("yzy_app","/api/User/getJsonZhyfOrderReturned","POST",s);case 6:c=r.sent,console.log(c),99==c.code?n.sendApplyReturned(c.data,o):(e.showToast({icon:"error",title:c.msg,duration:3e3}),e.hideLoading(),n.$refs.popup.close(),n.checkboxValue=0,n.$emit("childMethod")),r.next=14;break;case 11:r.prev=11,r.t0=r["catch"](3),e.showToast({icon:"error",title:r.t0,duration:3e3});case 14:case"end":return r.stop()}}),a,null,[[3,11]])})))()},sendApplyReturned:function(t,o){var n=this;return(0,a.default)(r.default.mark((function a(){var i,c,u;return r.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return"/api/Zhyf/getApplyForOuterOrderReturned","POST",i=JSON.parse(t),i.operateId=o,c=JSON.stringify(i),r.prev=5,r.next=8,(0,s.default)("yzy_app","/api/Zhyf/getApplyForOuterOrderReturned","POST",c);case 8:u=r.sent,console.log("申请退款成功！"),console.log(u),99==u.code?(e.hideLoading(),n.$refs.popup.close(),n.checkboxValue=0,n.$emit("childMethod"),n.textareaContent="",e.showToast({icon:"success",title:"申请成功，请等待审核",duration:3e3})):(e.showToast({icon:"error",title:u.msg,duration:3e3}),e.hideLoading(),n.$refs.popup.close(),n.checkboxValue=0,n.$emit("childMethod")),r.next=17;break;case 14:r.prev=14,r.t0=r["catch"](5),e.showToast({icon:"error",title:r.t0,duration:3e3});case 17:case"end":return r.stop()}}),a,null,[[5,14]])})))()},testExistsPrePayOrderWxPay:function(){var t=this;return(0,a.default)(r.default.mark((function o(){var n,a;return r.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return"/api/example/testExistsPrePayOrderWxPay","POST",n={businessUnitId:t.order.shopInfo[0].businessUnitId,openid:e.getStorageSync("openid"),main_order_id:t.order.main_order_id},o.prev=3,o.next=6,(0,i.default)("yzy_app","/api/example/testExistsPrePayOrderWxPay","POST",n);case 6:a=o.sent,console.log(a),99==a.code?t.requestWxPay(a.data,a.data.main_order_id):e.showToast({icon:"none",title:a.msg}),o.next=15;break;case 11:o.prev=11,o.t0=o["catch"](3),console.log(o.t0),e.showToast({icon:"none",title:"服务器出错了"});case 15:case"end":return o.stop()}}),o,null,[[3,11]])})))()},requestWxPay:function(t,o){var n=this;e.requestPayment({provider:"wxpay",timeStamp:t.timeStamp,nonceStr:t.nonceStr,package:t.package,signType:t.signType,paySign:t.paySign,success:function(r){console.log("支付成功"),e.showToast({icon:"success",title:"支付成功"}),n.testQueryPay(t.out_order_id,o)},fail:function(r){console.log("支付失败"),e.showToast({icon:"none",title:"支付失败"}),n.testQueryPay(t.out_order_id,o)}})},testQueryPay:function(t,o){var n=this;return(0,a.default)(r.default.mark((function a(){var s,c;return r.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return"/api/example/testQueryPayOrder","POST",s={openid:e.getStorageSync("openid"),main_order_id:o,out_order_id:t},r.prev=3,r.next=6,(0,i.default)("yzy_app","/api/example/testQueryPayOrder","POST",s);case 6:c=r.sent,console.log(c),99==c.code?n.uploadOrderToZhyf(c.msg,c.data.operateId):e.showToast({icon:"none",title:"查询失败"}),r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](3),console.log(r.t0),e.showToast({icon:"none",title:"服务器出错了"});case 15:case"end":return r.stop()}}),a,null,[[3,11]])})))()},uploadOrderToZhyf:function(e,t){var o=this;return(0,a.default)(r.default.mark((function n(){var a,i,c;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=JSON.parse(e),a.operateId=t,console.log(JSON.stringify(a)),"/api/Zhyf/makeAccountForOuterOrder","POST",i=JSON.stringify(a),n.prev=6,console.log(i),n.next=10,(0,s.default)("yzy_app","/api/Zhyf/makeAccountForOuterOrder","POST",i);case 10:c=n.sent,console.log(c),99==c.code&&(console.log("销售记录上传智慧药房成功！"),o.$emit("childMethod")),n.next=18;break;case 15:n.prev=15,n.t0=n["catch"](6),console.log(n.t0);case 18:case"end":return n.stop()}}),n,null,[[6,15]])})))()}}};t.default=c}).call(this,o("543d")["default"])}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/order/order_card-create-component',
    {
        'components/order/order_card-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("decb"))
        })
    },
    [['components/order/order_card-create-component']]
]);

(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/order/order_popup"],{"002d":function(o,e,t){"use strict";t.r(e);var n=t("85e8"),i=t("216f");for(var s in i)["default"].indexOf(s)<0&&function(o){t.d(e,o,(function(){return i[o]}))}(s);t("3e39");var r=t("f0c5"),c=Object(r["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);e["default"]=c.exports},"1c75":function(o,e,t){},"216f":function(o,e,t){"use strict";t.r(e);var n=t("8186"),i=t.n(n);for(var s in n)["default"].indexOf(s)<0&&function(o){t.d(e,o,(function(){return n[o]}))}(s);e["default"]=i.a},"3e39":function(o,e,t){"use strict";var n=t("1c75"),i=t.n(n);i.a},8186:function(o,e,t){"use strict";(function(o){var n=t("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n(t("2eee")),s=n(t("c973")),r=n(t("24db")),c={components:{goodsCard:function(){t.e("components/goods/goods_card").then(function(){return resolve(t("0faa"))}.bind(null,t)).catch(t.oe)}},name:"orderPopup",props:{shop:{type:Object,default:{}},goods:{type:Object,default:{}},orderType:{}},data:function(){return{num:1,localOrderType:"",recipeId:""}},watch:{orderType:{immediate:!0,deep:!0,handler:function(o){this.localOrderType=o}}},computed:{maxBuyNum:function(){return this.shop.limitNum>0?this.shop.inventory<this.shop.limitNum?this.shop.inventory:this.shop.limitNum:this.shop.inventory}},methods:{existsEffectiveRecipe:function(){var e=this;return(0,s.default)(i.default.mark((function t(){var n,s,c;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e,"处方药"!=e.goods.goodsType){t.next=16;break}return"/api/recipe/existsEffectiveRecipe","POST",s={openid:o.getStorageSync("openid"),goodsId:e.goods.goodsId,num:e.num},t.prev=5,t.next=8,(0,r.default)("yzy_app","/api/recipe/existsEffectiveRecipe","POST",s);case 8:c=t.sent,console.log(c),99==c.code&&("true"==c.data.data?(e.recipeId=c.data.recipeId,o.showModal({title:"注意",content:"您已存在一个可用处方,是否直接购买药品？",success:function(o){if(o.confirm)n.toBuyGoods();else if(o.cancel)return}})):e.toPrescription()),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](5),console.log(t.t0);case 16:case"end":return t.stop()}}),t,null,[[5,13]])})))()},toBuyGoods:function(){var e=[{id:0,shopName:this.shop.shopName,shopId:this.shop.shopId,simplifyShopName:this.shop.simplifyShopName,drugs:[{id:this.recipeId,drugId:this.goods.goodsId,drugName:this.goods.genericName,specification:this.goods.specification,price:this.shop.price,num:this.num,imgLszh:this.goods.goodsImg[0].tplszh,manufacturer:this.goods.manufacturer,sellUnit:this.goods.sellUnit}]}];o.navigateTo({url:"/pages/confirm_order/confirm_order?drug=".concat(encodeURIComponent(JSON.stringify(e)))})},numChange:function(o){this.num=o},submit:function(){var e={num:this.num,type:this.localOrderType};if(null!=this.shop.price&&0!=this.shop.price)if("问诊开方"==this.orderType){if(null==this.shop.inventory||0==this.shop.inventory)return void o.showToast({icon:"error",title:"库存不足"});this.existsEffectiveRecipe()}else{if(null==this.shop.inventory||0==this.shop.inventory)return void o.showToast({icon:"error",title:"库存不足"});this.$emit("closePopupBuyGoods",e)}else o.showToast({icon:"error",title:"暂无定价"})},toPrescription:function(){console.log(this.goods.goodsId),o.navigateTo({url:"/pages/consultation/consultation?goodsId=".concat(this.goods.goodsId,"&shopId=").concat(this.shop.shopId,"&goodsAmount=").concat(this.num,"&stockLimit=").concat(this.shop.limitNum,"&stock=").concat(this.shop.inventory)})}}};e.default=c}).call(this,t("543d")["default"])},"85e8":function(o,e,t){"use strict";t.d(e,"b",(function(){return i})),t.d(e,"c",(function(){return s})),t.d(e,"a",(function(){return n}));var n={uniNumberBox:function(){return t.e("uni_modules/uni-number-box/components/uni-number-box/uni-number-box").then(t.bind(null,"958a"))}},i=function(){var o=this.$createElement;this._self._c},s=[]}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/order/order_popup-create-component',
    {
        'components/order/order_popup-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("002d"))
        })
    },
    [['components/order/order_popup-create-component']]
]);

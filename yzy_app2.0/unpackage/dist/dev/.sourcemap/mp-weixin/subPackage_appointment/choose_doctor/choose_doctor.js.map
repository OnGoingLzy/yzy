{"version":3,"sources":["uni-app:///main.js","webpack:///E:/workbench/yzy/yzy_app2.0/subPackage_appointment/choose_doctor/choose_doctor.vue?8f9e","webpack:///E:/workbench/yzy/yzy_app2.0/subPackage_appointment/choose_doctor/choose_doctor.vue?08b3","webpack:///E:/workbench/yzy/yzy_app2.0/subPackage_appointment/choose_doctor/choose_doctor.vue?fd74","webpack:///E:/workbench/yzy/yzy_app2.0/subPackage_appointment/choose_doctor/choose_doctor.vue?6852","uni-app:///subPackage_appointment/choose_doctor/choose_doctor.vue","webpack:///E:/workbench/yzy/yzy_app2.0/subPackage_appointment/choose_doctor/choose_doctor.vue?46f1"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","renderjs","component","options","__file","components","uniPopup","e","message","indexOf","console","error","render","_vm","this","_h","$createElement","g0","_self","_c","filterDoctor","length","$mp","data","Object","assign","$root","recyclableRender","staticRenderFns","_withStripped","doctor","hospital","departmentSubClass","sevenDays","selectedIndex","selectedDate","clickDoctor","schedule","day","onLoad","mounted","methods","toSubmitAppointment","uni","url","setSchedule","openChooseSchedule","filterDoctorsByDate","targetDateObj","isWeekendDay","filteredData","calculateRemainedNum","remainedNum","generateSevenDays","date","selectDay","title","mask","getDoctor","that","method","departmentSubClassId","hospitalId","type","response","setTimeout","icon"],"mappings":"6KAAA,MAGA,aACA,YAFAA,EAAGC,kCAAoCC,EAGvCC,EAAWC,a,gFCLX,oIACIC,EADJ,QASIC,EAAY,qBACd,aACA,YACA,sBACA,EACA,KACA,KACA,MACA,EACA,gBACAD,GAGFC,EAAUC,QAAQC,OAAS,yDACZ,aAAAF,E,0CCvBf,uQ,iCCAA,IAAIG,EAAJ,0LACA,IACEA,EAAa,CACXC,SAAU,WACR,OAAO,qFAKX,MAAOC,GACP,IAC+C,IAA7CA,EAAEC,QAAQC,QAAQ,wBACa,IAA/BF,EAAEC,QAAQC,QAAQ,QAWlB,MAAMF,EATNG,QAAQC,MAAMJ,EAAEC,SAChBE,QAAQC,MAAM,mBACdD,QAAQC,MACN,uFAEFD,QAAQC,MACN,mDAMN,IAAIC,EAAS,WACX,IAAIC,EAAMC,KACNC,EAAKF,EAAIG,eAETC,GADKJ,EAAIK,MAAMC,GACVN,EAAIO,aAAaC,QAC1BR,EAAIS,IAAIC,KAAOC,OAAOC,OACpB,GACA,CACEC,MAAO,CACLT,GAAIA,MAKRU,GAAmB,EACnBC,EAAkB,GACtBhB,EAAOiB,eAAgB,G,iCC1CvB,yHAAyqB,eAAG,G,qJCyE5qB,W,EACA,CACAN,gBACA,OACAO,UACAC,cACAC,sBACAC,aACAC,gBACAC,kBACAf,gBACAgB,iBACAC,cACAC,SAGAC,mBAGA,yDACA,6EAEA,0BAIAC,mBACA,mBAEAC,SACAC,gCACAhC,eACA,uFACAiC,cACAC,mbAIAC,uBAEA,gDAIA,kCAIA,GAHA,8BAGA,8CACA,gCACA,0BAEA,sBAIA,kBAQAC,+BAEA,mBACA,mBACA,gCAGAC,+BACArC,oBA4CA,IA3CA,IACA,oBACA,WAuCA,KACA,qBACA,aACA,qBAEA,cAEA,IADA,wBACA,aACA,oBACA,4BACA,0BACA,cACA,qBACA,wBACA,GACAsC,MACAA,QACAC,MACA,CACAC,UACA,QAMAxC,eACA,qBAIAyC,gCAEA,uCAEA,QAEA,YACArB,gCAEAsB,mDAKAtB,oBAIAuB,6BAIA,IAHA,2CACA,WAEA,aACA,kBACAC,yBACA,oBACA,8CACA,yCACA,6BAEA,MAEA,qBAAAA,OAAAhB,WAEA,qBAAAgB,OAAAhB,UAKAiB,sBACAZ,eACAa,mBACAC,UAEA,eACA,kBACA,qBACA,+CACA,+BAEA,yCAIAC,wBAAA,kJASA,OARAC,IACAf,+BACAgB,SACArC,GACAsC,6CACAC,yBACAC,OACAT,QACA,mBAEA,qCAAAU,SAEAtD,eACA,wBAEA,WACA,qBACAuD,uBACAN,yBACAhB,kBACA,OAGA,qBACAsB,uBACAN,wBACAA,yBACAhB,kBACA,MAKAA,aACAa,iBACAU,cAEA,qDAEAxD,kBAAA,yDAxCA,MA4CA,c,6DC5TA,yHAA+8B,eAAG,G","file":"subPackage_appointment/choose_doctor/choose_doctor.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './subPackage_appointment/choose_doctor/choose_doctor.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./choose_doctor.vue?vue&type=template&id=cebaf078&\"\nvar renderjs\nimport script from \"./choose_doctor.vue?vue&type=script&lang=js&\"\nexport * from \"./choose_doctor.vue?vue&type=script&lang=js&\"\nimport style0 from \"./choose_doctor.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"subPackage_appointment/choose_doctor/choose_doctor.vue\"\nexport default component.exports","export * from \"-!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./choose_doctor.vue?vue&type=template&id=cebaf078&\"","var components\ntry {\n  components = {\n    uniPopup: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-popup/components/uni-popup/uni-popup\" */ \"@/uni_modules/uni-popup/components/uni-popup/uni-popup.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.filterDoctor.length\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./choose_doctor.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./choose_doctor.vue?vue&type=script&lang=js&\"","<template>\n\t<view>\r\n\t\t<!-- 顶部七天日期 -->\r\n\t\t<view class=\"date-container\">\r\n\t\t\t<view\r\n\t\t\t\tv-for=\"(day, index) in sevenDays\"\r\n\t\t\t\t:key=\"index\"\r\n\t\t\t\tclass=\"date-item\"\r\n\t\t\t\t@click=\"selectDay(index)\"\r\n\t\t\t\t:class=\"{ 'selected': selectedIndex === index }\"\r\n\t\t\t>\t\r\n\t\t\t\t<view><text class=\"day\">{{ day.day }}</text></view>\r\n\t\t\t\t<view>\r\n\t\t\t\t\t<text class=\"date\">{{ day.date }}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t  </view>\r\n\t\t</view>\r\n\t\t\n\t\t<view v-for=\"(item,i) in filterDoctor\" :key=\"i\" class=\"doctor-card\" @click=\"openChooseSchedule(item)\">\r\n\t\t\t<view style=\"    align-items: center;display: flex;justify-content: center;\">\r\n\t\t\t\t<image src=\"/static/icon/avatar.png\" class=\"avatar\"></image>\r\n\t\t\t</view>\r\n\t\t\t<view style=\"margin-left: 10px;\">\r\n\t\t\t\t<view>\r\n\t\t\t\t\t<text>{{item.name}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view>\r\n\t\t\t\t\t<text style=\"font-size: 11px;color: gray;\">{{item.position}}</text>\r\n\t\t\t\t</view><view>\r\n\t\t\t\t\t<text style=\"font-size: 12px;color: gray;\">{{'擅长：'+item.note}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view style=\"margin-left: auto;\">\r\n\t\t\t\t<view>\r\n\t\t\t\t\t<view :class=\"item.remainedNum>=0?'tag1':'tag2'\">\r\n\t\t\t\t\t\t<text v-text=\"item.remainedNum>=0?'可预约':'暂无号'\"></text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<!-- <text>{{'剩余号源：'+ item.remainedNum}}</text> -->\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<view v-if=\"filterDoctor.length==0\" style=\"text-align: center;\">\r\n\t\t\t<view>没有可预约挂号的医生</view>\r\n\t\t\t<image src=\"../../static/img/empty3.svg\" style=\"width: 50vw;height: 50vw;padding: 100rpx 0 120rpx 0;\"></image>\r\n\t\t</view>\r\n\t\t<uni-popup ref=\"popup\" type=\"right\" background-color=\"#fff\">\r\n\t\t\t<view>\r\n\t\t\t\t<view style=\"    text-align: center;font-weight: bold;\">\r\n\t\t\t\t\t{{selectedDate+' '+ clickDoctor.name + ' ' + clickDoctor.position}}\r\n\t\t\t\t</view>\r\n\t\t\t\t<view style=\"text-align: center;width: 100%;padding: 5px;\">\r\n\t\t\t\t\t<view>选择时间段：</view>\r\n\t\t\t\t\t<view v-for=\"(item,i) in schedule\" :key=\"i\" style=\"display: flex;align-items: center;\">\r\n\t\t\t\t\t\t<view @click=\"toSubmitAppointment(item)\" v-if=\"item.limitNum>item.alreadyAppointmentNum\" class=\"time-slot\" >\r\n\t\t\t\t\t\t\t{{item.appointmentTimeSlot}}\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view  v-if=\"item.limitNum<=item.alreadyAppointmentNum\" class=\"time-slot2\">\r\n\t\t\t\t\t\t\t{{item.appointmentTimeSlot}}\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<text>剩余数量：</text>\r\n\t\t\t\t\t\t<text >{{item.limitNum-item.alreadyAppointmentNum}}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t</view>\r\n\t\t</uni-popup>\r\n\t\t\n\t</view>\n</template>\n\n<script>\r\n\timport request from '@/common/api/request.js'\n\texport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tdoctor:[],\r\n\t\t\t\thospital:null,\r\n\t\t\t\tdepartmentSubClass:{},\r\n\t\t\t\tsevenDays: [],\r\n\t\t\t\tselectedIndex: 0,\r\n\t\t\t\tselectedDate: null,\r\n\t\t\t\tfilterDoctor:[],\r\n\t\t\t\tclickDoctor:null, //当前点击的医生\r\n\t\t\t\tschedule:null,//弹出层的时间表\r\n\t\t\t\tday:\"\",//当前选择的是周几\n\t\t\t}\n\t\t},\r\n\t\tonLoad: function (option) {\r\n\t\t\t//解析传过来的对象\r\n\t\t\r\n\t\t\tthis.hospital = JSON.parse(decodeURIComponent(option.hospital));\r\n\t\t\tthis.departmentSubClass = JSON.parse(decodeURIComponent(option.departmentSubClass));\r\n\r\n\t\t\tthis.generateSevenDays()\r\n\t\t\t\r\n\t\t\t\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tthis.selectDay(0)\r\n\t\t},\n\t\tmethods: {\r\n\t\t\ttoSubmitAppointment(schedule1){\r\n\t\t\t\tconsole.log(schedule1)\r\n\t\t\t\tvar departmentName = this.departmentSubClass.departmentName?this.departmentSubClass.departmentName:\"\"\r\n\t\t\t\tuni.redirectTo({\r\n\t\t\t\t\turl:\"/subPackage_appointment/appointment/submit_appointment?date=\"+encodeURIComponent(JSON.stringify(this.selectedDate))+'&schedule='+encodeURIComponent(JSON.stringify(schedule1))+'&hospital='+encodeURIComponent(JSON.stringify(this.hospital))+'&departmentInfo='+encodeURIComponent(JSON.stringify(departmentName+'-'+this.departmentSubClass.subclassName))+'&doctor='+encodeURIComponent(JSON.stringify(this.clickDoctor.name + ' ' + this.clickDoctor.position))\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t//设置弹出层时间表\r\n\t\t\tsetSchedule(){\r\n\t\t\t\t\r\n\t\t\t\tif (!this.clickDoctor || !this.clickDoctor.schedule) {\r\n\t\t\t\t    return; // 处理错误或无数据的情况\r\n\t\t\t\t  }\r\n\t\t\t\t\r\n\t\t\t\t  const selectedDate = new Date(this.selectedDate);\r\n\t\t\t\t  const selectedDateStr = selectedDate.toISOString().split('T')[0];\r\n\t\t\t\t\r\n\t\t\t\t  // 筛选符合条件的时间段\r\n\t\t\t\t  const filteredSlots = this.clickDoctor.schedule.filter((slot) => {\r\n\t\t\t\t    const startWorkTime = new Date(slot.startWorkTime);\r\n\t\t\t\t    const endWorkTime = new Date(slot.endWorkTime);\r\n\t\t\t\t\r\n\t\t\t\t    return selectedDate >= startWorkTime && selectedDate <= endWorkTime;\r\n\t\t\t\t  });\r\n\t\t\t\t  //console.log(filteredSlots)\r\n\t\t\t\t  \r\n\t\t\t\t  this.schedule = filteredSlots\r\n\t\t\t\t  // 提取并拼接时间段\r\n\t\t\t\t  // const appointmentTimeSlots = filteredSlots.map((slot) => slot.appointmentTimeSlot);\r\n\t\t\t\t  // this.schedule = appointmentTimeSlots\r\n\t\t\t\t  // appointmentTimeSlots 现在包含了所选日期的时间段\r\n\t\t\t\t  // console.log(appointmentTimeSlots);\r\n\t\t\t},\r\n\t\t\t//弹出选择时间表界面\r\n\t\t\topenChooseSchedule(doctor){\r\n\t\t\t  // 通过组件定义的ref调用uni-popup方法 ,如果传入参数 ，type 属性将失效 ，仅支持 ['top','left','bottom','right','center']\r\n\t\t\t  this.clickDoctor = doctor\r\n\t\t\t  this.setSchedule()\r\n\t\t\t  this.$refs.popup.open('right')\r\n\t\t\t},\r\n\t\t\t//根据日期筛选医生\r\n\t\t\tfilterDoctorsByDate() {\r\n\t\t\t\tconsole.log(\"筛选医生\")\r\n\t\t\t\tvar that = this\r\n\t\t\t\tvar targetDate = this.selectedDate\r\n\t\t\t\tvar day = this.day //现在周几\r\n\t\t\t\t\r\n\t\t\t\t//筛选法1\r\n\t\t\t\t// var filteredData = this.doctor.filter((doctor1) => {\r\n\t\t\t\t// \t// 使用 some 方法检查医生的时间表是否包含目标日期\r\n\t\t\t\t// \tif(doctor1.schedule){\r\n\t\t\t\t// \t\treturn doctor1.schedule.some((schedule) => {\r\n\t\t\t\t// \t\tconst startDate = new Date(schedule.startWorkTime);\r\n\t\t\t\t// \t\tconst endDate = new Date(schedule.endWorkTime);\r\n\t\t\t\t// \t\tconst targetDateObj = new Date(targetDate);\r\n\t\t\t\t// \t\t// 根据day和schedule.isWeekendWork来筛选医生\r\n\t\t\t\t// \t\tconst isWeekendDay = day === \"周六\" || day === \"周日\";\r\n\t\t\t\t// \t\tconst isWeekendWork = schedule.isWeekendWork === \"y\";\r\n\t\t\t\t// \t\treturn (\r\n\t\t\t\t// \t\t\ttargetDateObj >= startDate &&\r\n\t\t\t\t// \t\t\ttargetDateObj <= endDate &&\r\n\t\t\t\t// \t\t\t(isWeekendDay ? isWeekendWork : true)\r\n\t\t\t\t// \t\t);\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t// \t\t});\r\n\t\t\t\t\t\t\r\n\t\t\t\t// \t}\t\t\r\n\t\t\t //  });\r\n\t\t\t //--- 筛选法2\r\n\t\t\t // var filteredData = this.doctor.reduce((result, doctor1) => {\r\n\t\t\t //   if (doctor1.schedule && doctor1.schedule.some((schedule) => {\r\n\t\t\t //     const startDate = new Date(schedule.startWorkTime);\r\n\t\t\t //     const endDate = new Date(schedule.endWorkTime);\r\n\t\t\t //     const targetDateObj = new Date(targetDate);\r\n\t\t\t //     const isWeekendDay = day === \"周六\" || day === \"周日\";\r\n\t\t\t //     const isWeekendWork = schedule.isWeekendWork === \"y\";\r\n\t\t\t //     return targetDateObj >= startDate && targetDateObj <= endDate && (isWeekendDay ? isWeekendWork : true);\r\n\t\t\t //   })) {\r\n\t\t\t //     result.push(doctor1);\r\n\t\t\t //   }\r\n\t\t\t //   return result;\r\n\t\t\t // }, []);\r\n\t\t\t \r\n\t\t\t //筛选法3\r\n\t\t\tvar filteredData = [];\n\t\t\tvar len = this.doctor.length;\n\t\t\tfor (var i = 0; i < len; i++) {\n\t\t\t  var doctor1 = this.doctor[i];\r\n\t\t\t  \n\t\t\t  if (doctor1.schedule) {\n\t\t\t\tvar scheduleLen = doctor1.schedule.length;\n\t\t\t\tfor (var j = 0; j < scheduleLen; j++) {\n\t\t\t\t  var schedule = doctor1.schedule[j];\n\t\t\t\t  var startDate = new Date(schedule.startWorkTime);\n\t\t\t\t  var endDate = new Date(schedule.endWorkTime);\n\t\t\t\t  var targetDateObj = new Date(targetDate);\n\t\t\t\t  var isWeekendDay = day === \"周六\" || day === \"周日\";\n\t\t\t\t  var isWeekendWork = schedule.isWeekendWork === \"y\";\n\t\t\t\t  if (\n\t\t\t\t\ttargetDateObj >= startDate &&\n\t\t\t\t\ttargetDateObj <= endDate &&\n\t\t\t\t\t(isWeekendDay ? isWeekendWork : true)\n\t\t\t\t  ) {\n\t\t\t\t\tfilteredData.push(doctor1);\n\t\t\t\t\tbreak; // 医生满足条件，退出内层循环\n\t\t\t\t  }\n\t\t\t\t}\n\t\t\t  }\n\t\t\t}\n\r\n\t\t\t  console.log(filteredData)\r\n\t\t\t  this.filterDoctor=filteredData\r\n\t\t\t\r\n\t\t\t},\r\n\t\t\t//计算剩余号源数\r\n\t\t\tcalculateRemainedNum(){\r\n\r\n\t\t\t\tthis.filterDoctor.forEach((doctor) => {\r\n\t\t\t\t  // 初始化剩余数量为0\r\n\t\t\t\t  let remainedNum = 0;\r\n\t\t\t\t  \r\n\t\t\t\t  if (doctor.schedule) {\r\n\t\t\t\t    doctor.schedule.forEach((schedule) => {\r\n\t\t\t\t      // 计算剩余数量：limitNum之和减去alreadyAppointmentNum之和\r\n\t\t\t\t      remainedNum += (schedule.limitNum || 0) - (schedule.alreadyAppointmentNum || 0);\r\n\t\t\t\t    });\r\n\t\t\t\t  }\r\n\t\t\t\r\n\t\t\t\t  // 将计算的剩余数量赋值给每个医生对象的 remainedNum 属性\r\n\t\t\t\t  doctor.remainedNum = remainedNum;\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t// 生成七天日期和星期几\r\n\t\t\tgenerateSevenDays() {\r\n\t\t\t  const days = ['周日', '周一', '周二', '周三', '周四', '周五', '周六'];\r\n\t\t\t  const today = new Date();\r\n\t\t\t\r\n\t\t\t  for (let i = 0; i < 7; i++) {\r\n\t\t\t    const date = new Date(today);\r\n\t\t\t    date.setDate(today.getDate() + i);\r\n\t\t\t    const dayOfWeek = days[date.getDay()];\r\n\t\t\t    const month = (date.getMonth() + 1).toString().padStart(2, '0'); \r\n\t\t\t    const day = date.getDate().toString().padStart(2, '0');   //必须两位的日期与月份，不然ios端不兼容该日期\r\n\t\t\t    const formattedDate = `${month}-${day}`;\r\n\t\t\t\r\n\t\t\t    if (i === 0) {\r\n\t\t\t      // 如果是当天，将 dayOfWeek 设置为 \"今天\"\r\n\t\t\t      this.sevenDays.push({ date: formattedDate, day: '今天' });\r\n\t\t\t    } else {\r\n\t\t\t      this.sevenDays.push({ date: formattedDate, day: dayOfWeek });\r\n\t\t\t    }\r\n\t\t\t  }\r\n\t\t\t},\r\n\r\n\t\t\tselectDay(index) {\r\n\t\t\t  uni.showLoading({\r\n\t\t\t  \ttitle:\"loading...\",\r\n\t\t\t\tmask:true\r\n\t\t\t  })\r\n\t\t\t  const today = new Date();\r\n\t\t\t  const currentYear = today.getFullYear();\r\n\t\t\t  this.selectedIndex = index;\r\n\t\t\t  this.selectedDate = currentYear+'-'+this.sevenDays[index].date;\r\n\t\t\t  this.day = this.sevenDays[index].day\r\n\t\t\t  var that = this\r\n\t\t\t  this.getDoctor(this.selectedDate,\"day\") \r\n\t\t\t  \r\n\t\t\t  \r\n\t\t\t},\n\t\t\tasync getDoctor(date,type){\r\n\t\t\t\tvar that = this\r\n\t\t\t\tconst url = '/api/appointment/getDoctor';\r\n\t\t\t\tconst method = 'POST'; \r\n\t\t\t\tconst data = {\r\n\t\t\t\t\tdepartmentSubClassId: this.departmentSubClass.id,\r\n\t\t\t\t\thospitalId:this.hospital.id,\r\n\t\t\t\t\ttype:type,\r\n\t\t\t\t\tdate:date\r\n\t\t\t\t};\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst response = await request('yzy_app', url, method, data);\r\n\t\t\t\t\t\t//统一格式：{\"data\":{}, \"flag\":99, \"result\":\"成功\"}\r\n\t\t\t\t\t\tconsole.log(response)\r\n\t\t\t\t\tif(response.code == 99 && response.data.data){\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif(type=='week'){\r\n\t\t\t\t\t\t\tthis.doctor = response.data.data\r\n\t\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\t\tthat.calculateRemainedNum()\r\n\t\t\t\t\t\t\t\tuni.hideLoading()\t\t\t \r\n\t\t\t\t\t\t\t},500)\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tthis.doctor = response.data.data\r\n\t\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\t\tthat.filterDoctorsByDate()\r\n\t\t\t\t\t\t\t\tthat.calculateRemainedNum()\r\n\t\t\t\t\t\t\t\tuni.hideLoading()\t\t\t \r\n\t\t\t\t\t\t\t},500)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '没有查到任何数据',\r\n\t\t\t\t\t\t\ticon:\"none\"\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.log(error);\r\n\t\t\t\t}\r\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style>\r\n.tag1{\r\n\tpadding: 0 2px;\r\n\tborder-radius: 3px;\r\n\tborder: #1296DB 1px solid;\r\n\tcolor: #1296DB;\r\n}\r\n.tag2{\r\n\tpadding: 0 2px;\r\n\tborder-radius: 3px;\r\n\tborder: gray 1px solid;\r\n\tcolor: gray;\r\n}\r\n.time-slot{\r\n\tcolor: #1296DB;\r\n\ttext-align: center;\r\n\tmargin-top: 5px;\r\n\tborder-radius: 5px;\r\n\twidth: 25vw;\r\n\theight: 25px;\r\n\tborder: #1296DB 2px solid;\r\n}\r\n.time-slot2{\r\n\tcolor: gray;\r\n\ttext-align: center;\r\n\tmargin-top: 5px;\r\n\tborder-radius: 5px;\r\n\twidth: 25vw;\r\n\theight: 25px;\r\n\tborder: gray 2px solid;\r\n}\r\n.date-container {\r\n  background: #1296DB;\n  display: flex;\n  justify-content: space-between;\n  padding: 10px;\n}\n\n.date-item {\r\n\twidth: 107rpx;\n  text-align: center;\r\n  line-height: 19px;\r\n  border: 2px solid transparent; /* 初始状态无边框 */\r\n  border-radius: 10px; /* 圆角效果 */\n}\n\n.date {\n  font-size: 15px;\n  color: #fff;\n}\n.date-item.selected {\n  border-color: #fff; /* 点击后显示黑色边框 */\n}\n.day {\n  font-size: 14px;\n  color: #fff;\n}\t\n.doctor-card{\r\n\tdisplay: flex;\r\n\tpadding: 5px;\r\n\tborder-bottom: #f2f3f4 1px solid;\r\n}\r\n.avatar{\r\n\twidth: 36px;\r\n\theight: 36px;\r\n\tborder-radius: 50%;\r\n\tborder: 2px solid #FFF;\r\n\tbox-shadow: 0 1px 5px black;\r\n}\n</style>\n","import mod from \"-!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./choose_doctor.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./choose_doctor.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}
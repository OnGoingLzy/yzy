{"version":3,"sources":["uni-app:///main.js","webpack:///E:/workbench/yzy/yzy_app2.0/pages/shops_selling_This_goods/shops_selling_This_goods.vue?9f0e","webpack:///E:/workbench/yzy/yzy_app2.0/pages/shops_selling_This_goods/shops_selling_This_goods.vue?beca","webpack:///E:/workbench/yzy/yzy_app2.0/pages/shops_selling_This_goods/shops_selling_This_goods.vue?3115","webpack:///E:/workbench/yzy/yzy_app2.0/pages/shops_selling_This_goods/shops_selling_This_goods.vue?5174","uni-app:///pages/shops_selling_This_goods/shops_selling_This_goods.vue","webpack:///E:/workbench/yzy/yzy_app2.0/pages/shops_selling_This_goods/shops_selling_This_goods.vue?5217"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","renderjs","component","options","__file","components","uniPopup","uniTag","e","message","indexOf","console","error","render","_vm","this","_h","$createElement","l0","_self","_c","__map","filterRule","businessUnit","item","i","$orig","__get_orig","m0","getTagType","$mp","data","Object","assign","$root","recyclableRender","staticRenderFns","_withStripped","goods","choiceBar","sortRule","useFilterRule","useFilter","filterShopList","shopsList","latitude","longitude","firstClickLocation","goodsCard","shopCard","mounted","onLoad","onUnload","computed","filteredShopsList","methods","resetFilterRule","clickBusinessUnit","createfilterRule","shopList","uniqueBusinessUnits","toGoodsDetails","uni","url","selectBar","success","that","shop","fail","title","content","authVerification","handleOpenSetting","icon","sortShopsList","calculateDistance","Math","degreesToRadians","getShops","method","goods_json","goodsId","res","setTimeout","getUserLocation","type"],"mappings":"kLAAA,MAGA,aACA,YAFAA,EAAGC,kCAAoCC,EAGvCC,EAAWC,a,gFCLX,oIACIC,EADJ,QASIC,EAAY,qBACd,aACA,YACA,sBACA,EACA,KACA,KACA,MACA,EACA,gBACAD,GAGFC,EAAUC,QAAQC,OAAS,8DACZ,aAAAF,E,0CCvBf,uQ,iCCAA,IAAIG,EAAJ,0LACA,IACEA,EAAa,CACXC,SAAU,WACR,OAAO,oFAITC,OAAQ,WACN,OAAO,+EAKX,MAAOC,GACP,IAC+C,IAA7CA,EAAEC,QAAQC,QAAQ,wBACa,IAA/BF,EAAEC,QAAQC,QAAQ,QAWlB,MAAMF,EATNG,QAAQC,MAAMJ,EAAEC,SAChBE,QAAQC,MAAM,mBACdD,QAAQC,MACN,uFAEFD,QAAQC,MACN,mDAMN,IAAIC,EAAS,WACX,IAAIC,EAAMC,KACNC,EAAKF,EAAIG,eAETC,GADKJ,EAAIK,MAAMC,GACVN,EAAIO,MAAMP,EAAIQ,WAAWC,cAAc,SAAUC,EAAMC,GAC9D,IAAIC,EAAQZ,EAAIa,WAAWH,GACvBI,EAAKd,EAAIe,WAAWL,GACxB,MAAO,CACLE,MAAOA,EACPE,GAAIA,OAGRd,EAAIgB,IAAIC,KAAOC,OAAOC,OACpB,GACA,CACEC,MAAO,CACLhB,GAAIA,MAKRiB,GAAmB,EACnBC,EAAkB,GACtBvB,EAAOwB,eAAgB,G,iCCtDvB,yHAAorB,eAAG,G,uJCqDvrB,iPACA,CACAN,gBACA,OACAO,SACAC,kBACAC,cACAlB,YACAC,iBAEAkB,eACAlB,iBAEAmB,aACAC,kBACAC,aACAC,cACAC,eACAC,wBAIA1C,YAAA2C,YAAAC,YAEAC,mBAEA,uBAEAC,mBAEA,oDAGAC,oBACAzC,uBAIA0C,UACAC,6BAAA,WACA,iDAEA,eAGA,mCACA,0CACA,kDAMAC,SACAC,2BACA,mCACA,oCAGA3B,uBACA,4CACA,4BAGA,uBAIA4B,gCACA,iDACA,6BAEA,MAEA,wCAGA,4CAEA,0CACA,kBACA,mBAIAC,6BACA,cACAC,uBACAC,6BAEA,4CAGAC,6BACAlD,eACAmD,cACAC,wIAIAC,wBAEArD,eACA,WACA,+BAEA,oBACA,kBAEA,wBACA,wBAEAmD,uBACAG,oBACAtD,qDACAmD,gCACAI,sBACAA,wBAGAA,iCACAC,0DAEAD,wBACAA,gCAIAE,iBACAzD,6CACAmD,aACAO,WACAC,uBACAL,oBACA,aACAC,0BACA,YAEA,YADAA,8BAUAA,+BAIA,iCACA,wBACA,6CACA,kCACA,uCACA,oCAIA,YACA,+BAEA,iCACA,uCACAJ,mBAEAS,4BAAA,WACA,OACAT,cACAG,oBACA,oCACAC,6BACA,yCACAvD,oBACA,uBAEA,0BAKA6D,6BACA,WACA5E,eACAqE,oBACAtD,gCACA,oCACAuD,yBAEAJ,aACAO,aACAI,cAEAP,6BAKAQ,0BACA,WAEA,6DAEA,WACA,6DAEA,kBAEA,qEAEA,UAGA,mEACAZ,kBAKAa,gCACA,WACA,yCACA,0CACA,EACAC,4BACAA,kFACAA,4BACA,4CACA,MACA,qBAEAC,6BACA,wBAGAC,uBAAA,gJAgBA,OAfA,aACA,cACAnE,wBACAmD,eACAO,gBAEAH,EACAvD,oBACAoD,0BACAgB,SACAhD,GACAiD,mBACAnC,WACAC,YACAmC,yBACA,oBAEA,sCAAAC,SACAvE,eACA,YACA,wBACA,gCACA,wBAEAwE,uBACArB,kBACA,MAIAA,gBACA,qDAEAA,gBAAA,yDAlCA,IAsCAsB,2BACAzE,oBACA,WACAmD,eACAuB,aACApB,oBACAtD,eACAuD,oCAEAE,wBAMA,c,6ECtVA,yHAAuwC,eAAG,G","file":"pages/shops_selling_This_goods/shops_selling_This_goods.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/shops_selling_This_goods/shops_selling_This_goods.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./shops_selling_This_goods.vue?vue&type=template&id=13edd974&\"\nvar renderjs\nimport script from \"./shops_selling_This_goods.vue?vue&type=script&lang=js&\"\nexport * from \"./shops_selling_This_goods.vue?vue&type=script&lang=js&\"\nimport style0 from \"./shops_selling_This_goods.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/shops_selling_This_goods/shops_selling_This_goods.vue\"\nexport default component.exports","export * from \"-!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./shops_selling_This_goods.vue?vue&type=template&id=13edd974&\"","var components\ntry {\n  components = {\n    uniPopup: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-popup/components/uni-popup/uni-popup\" */ \"@/uni_modules/uni-popup/components/uni-popup/uni-popup.vue\"\n      )\n    },\n    uniTag: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-tag/components/uni-tag/uni-tag\" */ \"@/uni_modules/uni-tag/components/uni-tag/uni-tag.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var l0 = _vm.__map(_vm.filterRule.businessUnit, function (item, i) {\n    var $orig = _vm.__get_orig(item)\n    var m0 = _vm.getTagType(item)\n    return {\n      $orig: $orig,\n      m0: m0,\n    }\n  })\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        l0: l0,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./shops_selling_This_goods.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./shops_selling_This_goods.vue?vue&type=script&lang=js&\"","<template>\n\t<view>\n\t\t<view class=\"goods-card\"> \n\t\t\t<goodsCard :goods=\"goods\" :showImgNum=\"'all'\"></goodsCard>\n\t\t\t<text style=\"color: #bfbfbf;font-size: 14px;\">{{goods.tssm1}}</text>\n\t\t</view>\n\t\t<view class=\"choice-bar-container\">\n\t\t\t<view class=\"choice-bar-item-box\" @click=\"selectBar('test0')\">\n\t\t\t\t<text ref=\"text0\" @click=\"selectBar('test0')\" :style=\"{ color: choiceBar === 'test0' ? '#1296DB' : 'black' }\" >默认</text>\n\t\t\t</view>\t\n\t\t\t<view class=\"choice-bar-item-box\"  @click=\"selectBar('test1')\">\n\t\t\t\t<text ref=\"test1\" :style=\"{ color: choiceBar === 'test1' ? '#1296DB' : 'black' }\">距离</text>\n\t\t\t</view>\n\t\t\t\n\t\t\t<view class=\"choice-bar-item-box\" @click=\"selectBar('test2')\">\n\t\t\t\t<text ref=\"text2\"  :style=\"{ color: choiceBar === 'test2' ? '#1296DB' : 'black' }\">库存</text>\n\t\t\t</view>\n\t\t\t\n\t\t\t<view class=\"choice-bar-item-box\"  @click=\"selectBar('test3','price')\">\n\t\t\t\t<view style=\"display: flex;align-items: center;\">\n\t\t\t\t\t<text ref=\"test1\"  :style=\"{ color: choiceBar === 'test3' ? '#1296DB' : 'black' }\">价格</text>\n\t\t\t\t\t\t<text class=\"mini-text\" :style=\"{ color: sortRule === '价格降序' ? '#1296DB' : '#777777' }\" v-if=\"sortRule === '价格降序'\" >↓</text>\n\t\t\t\t\t\t<text class=\"mini-text\" :style=\"{ color: sortRule === '价格升序' ? '#1296DB' : '#777777' }\" v-if=\"sortRule === '价格升序'\" >↑</text>\n\t\t\t\t</view>\t\n\t\t\t</view>\n\t\t\t<view class=\"choice-bar-item-box\" @click=\"selectBar('test4')\">\n\t\t\t\t<text ref=\"text4\"  :style=\"{ color: !useFilter ? 'black' : '#1296DB' }\">筛选</text>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t<!-- 店铺列表 -->\n\t\t<view v-for=\"(shop, i) in filteredShopsList\" :key=\"i\"   class=\"shops-container\">\n\t\t\t<shopCard :shop=\"shop\" :goods=\"goods\"></shopCard>\n\t\t</view>\n\t\t\t\n\t\t<uni-popup ref=\"popup\" type=\"right\" background-color=\"#fff\" >\r\n\t\t\t<view style=\"width: 70vw;padding: 5px;\">\r\n\t\t\t\t<text style=\"font-weight: bold;\">筛选</text>\r\n\t\t\t\t<view style=\"padding: 5px;\">\r\n\t\t\t\t\t<uni-tag v-for=\"(item,i) in filterRule.businessUnit\" :key=\"i\" :text=\"item\" style=\"margin: 5px;\" @click=\"clickBusinessUnit(item,i)\" :type=\"getTagType(item)\"></uni-tag>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"filter-button-container\">\r\n\t\t\t\t<button type=\"primary\" @click=\"resetFilterRule\">重置</button>\r\n\t\t\t</view>\r\n\t\t</uni-popup>\r\n\t\t\n\t</view>\n</template>\n\n<script>\n\timport goodsCard from '@/components/goods/goods_card.vue';\n\timport shopCard from '@/components/shop/shop_card.vue'\n\timport request from '@/common/api/request.js'\n\texport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tgoods:{},\n\t\t\t\tchoiceBar:\"test1\",\n\t\t\t\tsortRule:'距离',\n\t\t\t\tfilterRule:{\r\n\t\t\t\t\tbusinessUnit:[],\r\n\t\t\t\t},//筛选条件\r\n\t\t\t\tuseFilterRule:{\r\n\t\t\t\t\tbusinessUnit:[]\r\n\t\t\t\t},//使用的筛选条件\r\n\t\t\t\tuseFilter:false,\r\n\t\t\t\tfilterShopList:[],\n\t\t\t\tshopsList:[],\r\n\t\t\t\tlatitude:null,\r\n\t\t\t\tlongitude:null,\r\n\t\t\t\tfirstClickLocation:true,\r\n\n\t\t\t}\n\t\t},\n\t\tcomponents:{goodsCard,shopCard},\n\t\t// navigate.vue页面接受参数\n\t\tmounted() {\n\t\t\t// this.getUserLocation()\r\n\t\t\tthis.getShops(102,24)\n\t\t},\n\t\tonLoad: function (option) {\n\t\t\t//解析传过来的对象\n\t\t\tthis.goods = JSON.parse(decodeURIComponent(option.goods));\n\n\t\t},\r\n\t\tonUnload() {\r\n\t\t    console.log(\"关闭实时定位\")\r\n\t\t    //uni.offLocationChange()\r\n\t\t  },\r\n\t\t\r\n\t\tcomputed:{\r\n\t\t\tfilteredShopsList() {\r\n\t\t\t  if (this.useFilterRule.businessUnit.length == 0) {\r\n\t\t\t    // No filter, return the original shopsList\r\n\t\t\t    return this.shopsList;\r\n\t\t\t  } else {\r\n\t\t\t    // Apply filter based on businessUnitName\r\n\t\t\t    return this.shopsList.filter((shop) => {\r\n\t\t\t      return this.useFilterRule.businessUnit.some(\r\n\t\t\t        (unit) => unit === shop.businessUnitName\r\n\t\t\t      );\r\n\t\t\t    });\r\n\t\t\t  }\r\n\t\t\t},\r\n\t\t},\n\t\tmethods: {\r\n\t\t\tresetFilterRule(){\r\n\t\t\t\tthis.useFilterRule.businessUnit=[]\r\n\t\t\t\tthis.filterShopList = this.shopsList\r\n\t\t\t},\r\n\t\t\t//获取uni-tag样式类型\r\n\t\t\tgetTagType(item) {\r\n\t\t\t  const isSelected = this.useFilterRule.businessUnit.some(\r\n\t\t\t    (unit) => unit === item\r\n\t\t\t  );\r\n\t\t\r\n\t\t\t  return  isSelected ? 'primary' : '';\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t//筛选中点击业务单元筛选条件\t\t\r\n\t\t\tclickBusinessUnit(item,index) {\r\n\t\t\t\tconst useIndex = this.useFilterRule.businessUnit.findIndex(\r\n\t\t\t\t  (unit) => unit === item\r\n\t\t\t\t);\r\n\t\t\t      if (useIndex === -1) {\r\n\t\t\t        // 加入筛选\r\n\t\t\t        this.useFilterRule.businessUnit.push(item);\r\n\t\t\t      } else {\r\n\t\t\t        // 移除筛选\r\n\t\t\t        this.useFilterRule.businessUnit.splice(useIndex, 1);\r\n\t\t\t      }\r\n\t\t\t\tif(this.useFilterRule.businessUnit.length!=0){\r\n\t\t\t\t\tthis.useFilter=true\r\n\t\t\t\t}  else this.useFilter=false\r\n\t\t\t\t  \r\n\t\t\t},\r\n\t\t\t//创建筛选条件\r\n\t\t\tcreatefilterRule(shopList){\t\t\t\r\n\t\t\t\tconst uniqueBusinessUnits = new Set();\r\n\t\t\t\t      shopList.forEach((shop) => {\r\n\t\t\t\t        uniqueBusinessUnits.add(shop.businessUnitName);\r\n\t\t\t\t      });\r\n\t\t\t\t      this.filterRule.businessUnit = Array.from(uniqueBusinessUnits);\r\n\t\t\t\t    \r\n\t\t\t},\n\t\t\ttoGoodsDetails(goods,shop){\n\t\t\t\tconsole.log(goods)\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl:\"/pages/goods_details/goods_details?goods=\"+encodeURIComponent(JSON.stringify(goods))+\"&shop=\"+encodeURIComponent(JSON.stringify(shop))\n\t\t\t\t\t//传对象参数给这个页面需要使用这个方法\n\t\t\t\t})\n\t\t\t},\n\t\t\tselectBar(num,sort){\r\n\t\t\t\t\n\t\t\t\tconsole.log(num)\r\n\t\t\t\tvar that = this\r\n\t\t\t\tif(num!='test4')this.choiceBar=num\n\t\t\t\t\n\t\t\t\tvar sortRule = this.sortRule\r\n\t\t\t\tif(num=='test1') {\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.sortRule='距离'\r\n\t\t\t\t\tif(this.firstClickLocation){//若是第一次点击则开启定位\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tuni.startLocationUpdate({\r\n\t\t\t\t\t\t    success: res => {\r\n\t\t\t\t\t\t        console.log('startLocationUpdate用户开启使用小程序期间位置权限:',res)\r\n\t\t\t\t\t\t        uni.onLocationChange(function (res) {\r\n\t\t\t\t\t\t\t\t\tthat.latitude=res.latitude\r\n\t\t\t\t\t\t\t\t\tthat.longitude=res.longitude\r\n\t\t\t\t\t\t\t\t\t// 计算每个商店到用户位置的距离，并添加一个 distance 属性\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tthat.shopsList.forEach(shop => {\r\n\t\t\t\t\t\t\t\t\t\tshop.distance = that.calculateDistance(shop.latitude, shop.longitude);\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tthat.firstClickLocation = false\t\r\n\t\t\t\t\t\t\t\t\tthat.sortShopsList(that.sortRule)\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t        });\r\n\t\t\t\t\t\t    },\r\n\t\t\t\t\t\t    fail: err => {\r\n\t\t\t\t\t\t        console.log('startLocationUpdate获取当前位置失败', err)\r\n\t\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\t\ttitle: '授权',\r\n\t\t\t\t\t\t\t\t\tcontent: '需要授权才能获取位置信息',\r\n\t\t\t\t\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\t\t\t\t\tthat.authVerification()\r\n\t\t\t\t\t\t\t\t\t\t} else if (res.cancel) {\r\n\t\t\t\t\t\t\t\t\t\t\tthat.selectBar('test0','')\r\n\t\t\t\t\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t    },\r\n\t\t\t\t\t\t    \r\n\t\t\t\t\t\t})\t\r\n\t\t\t\t\t}else\r\n\t\t\t\t\tthat.sortShopsList(that.sortRule)\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn\r\n\t\t\t\t} \n\t\t\t\tif(num=='test2') this.sortRule='库存'\n\t\t\t\tif(num=='test3'&&sort=='price'){\n\t\t\t\t\tif(sortRule!='价格升序'||sortRule!='价格降序') this.sortRule='价格降序'\n\t\t\t\t\tif(sortRule=='价格升序') this.sortRule='价格降序'\n\t\t\t\t\tif(sortRule=='价格降序') this.sortRule='价格升序'\n\t\t\t\t\tthis.sortShopsList(this.sortRule)\n\t\t\t\t\treturn\n\t\t\t\t} \n\t\t\t\t\n\t\t\t\tif(num=='test4') {\r\n\t\t\t\t\tthis.$refs.popup.open('right')\r\n\t\t\t\t}\n\t\t\t\tif(num=='test0') this.sortRule='默认'\n\t\t\t\tthis.sortShopsList(this.sortRule)\n\t\t\t\tuni.hideLoading()\n\t\t\t},\r\n\t\t\tauthVerification(){\r\n\t\t\t\tvar that = this\r\n\t\t\t\tuni.getSetting({\r\n\t\t\t\t  success: (res) => {\r\n\t\t\t\t    if (res.authSetting['scope.userLocation']) { /* 用户授权成功时走这里 */\r\n\t\t\t\t      that.selectBar('test1','')\r\n\t\t\t\t    } else if (res.authSetting['scope.userLocation'] === undefined) { /* 用户未授权时走这里 */\r\n\t\t\t\t      console.log('没有授权')\r\n\t\t\t\t      this.handleOpenSetting()\r\n\t\t\t\t    } else { /* 用户拒绝了授权后走这里 */\r\n\t\t\t\t      this.handleOpenSetting()\r\n\t\t\t\t    }\r\n\t\t\t\t  },\r\n\t\t\t\t})\r\n\t\t\t},\t\r\n\t\t\thandleOpenSetting () {\r\n\t\t\t\tvar that = this\r\n\t\t\t  wx.openSetting({\r\n\t\t\t    success: (res) => {\r\n\t\t\t      console.log('定位 openSetting', res)\r\n\t\t\t      if (res.authSetting[\"scope.userLocation\"]) {\r\n\t\t\t        that.selectBar('test1','')\r\n\t\t\t      }else{\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle:'授权失败',\r\n\t\t\t\t\t\ticon:'none'\r\n\t\t\t\t\t})  \r\n\t\t\t\t\tthat.selectBar('test0','')\r\n\t\t\t\t  }\r\n\t\t\t    }\r\n\t\t\t  })\r\n\t\t\t},\n\t\t\tsortShopsList(sortRule) {\n\t\t\t\tif(sortRule=='价格降序'){\n\t\t\t\t\t// 使用 Array.prototype.sort() 方法对 searchResults 进行排序\n\t\t\t\t\tthis.shopsList.sort((a, b) => a.price - b.price);\n\t\t\t\t}\n\t\t\t    if(sortRule=='价格升序'){\n\t\t\t    \tthis.shopsList.sort((a, b) => b.price - a.price);\n\t\t\t    }\r\n\t\t\t\tif(sortRule=='库存' || sortRule=='默认'){\r\n\t\t\t\t\t// 使用 Array.prototype.sort() 方法对 searchResults 进行排序\r\n\t\t\t\t\tthis.shopsList.sort((a, b) => b.inventory - a.inventory);\r\n\t\t\t\t}\r\n\t\t\t\tif(sortRule=='距离'){\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 使用 Array.prototype.sort() 方法根据距离进行排序\r\n\t\t\t\t\tthis.shopsList.sort((a, b) => a.distance - b.distance);\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t}\t\r\n\t\t\t\t\n\t\t\t},\r\n\t\t\t//根据经纬度计算距离\r\n\t\t\tcalculateDistance(latitude, longitude) {\t\t\r\n\t\t\t\tconst earthRadius = 6371; // 地球半径，单位：公里\n\t\t\t\tconst dLat = this.degreesToRadians(latitude - this.latitude);\n\t\t\t\tconst dLon = this.degreesToRadians(longitude - this.longitude);\n\t\t\t\tconst a =\n\t\t\t\t\tMath.sin(dLat / 2) * Math.sin(dLat / 2) +\n\t\t\t\t\tMath.cos(this.degreesToRadians(this.latitude)) * Math.cos(this.degreesToRadians(latitude)) *\n\t\t\t\t\tMath.sin(dLon / 2) * Math.sin(dLon / 2);\n\t\t\t\tconst c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n\t\t\t\tconst distance = earthRadius * c;\n\t\t\t\treturn distance.toFixed(2);\r\n\t\t\t},\r\n\t\t\tdegreesToRadians(degrees) {\r\n\t\t\t  return degrees * (Math.PI / 180);\r\n\t\t\t},\n\t\t\t//获取售卖该药的门店\n\t\t\t async getShops(jingdu,weidu){\n\t\t\t\tthis.latitude=weidu\r\n\t\t\t\tthis.longitude=jingdu\r\n\t\t\t\tconsole.log(this.latitude)\n\t\t\t\tuni.showLoading({\n\t\t\t\t\ttitle:\"搜索中..\"\n\t\t\t\t})\n\t\t\t\tvar that = this\n\t\t\t\tconsole.log(\"查询门店\")\n\t\t\t\tconst url = '/api/shop/searchShops';\n\t\t\t\tconst method = 'POST'; \n\t\t\t\tconst data = {\n\t\t\t\t\tgoods_json: this.goods,\n\t\t\t\t\tlatitude: weidu,\n\t\t\t\t\tlongitude: jingdu,\r\n\t\t\t\t\tgoodsId: this.goods.goodsId\n\t\t\t\t};\n\t\t\t\ttry {\n\t\t\t\t\tconst res = await request('yzy_app', url, method, data);\n\t\t\t\t\tconsole.log(res);\t\t//统一格式：{\"data\":{}, \"flag\":99, \"result\":\"成功\"}\n\t\t\t\t\tif(res.code == 99){\n\t\t\t\t\t\tthis.shopsList = res.data.data\t\t\t\t\t\t\r\n\t\t\t\t\t\tthis.createfilterRule(res.data.data)\r\n\t\t\t\t\t\tthis.selectBar('test1','')\r\n\t\t\t\t\t\t//this.sortShopsList(this.sortRule)\t\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t\t},1000)\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\tuni.hideLoading()\n\t\t\t\t}\n\t\t\t\t\n\t\t\t},\n\t\t\tgetUserLocation(){\n\t\t\t\tconsole.log(\"获取位置\")\n\t\t\t\tlet that = this\n\t\t\t\tuni.getLocation({\n\t\t\t\t\ttype: 'gcj02', //返回可以用于uni.openLocation的经纬度\n\t\t\t\t\tsuccess: function(res) {\n\t\t\t\t\t\tconsole.log(res)\t\n\t\t\t\t\t\tthat.getShops(res.longitude,res.latitude)\t\t\t\t\t\t\n\t\t\t\t\t},\n\t\t\t\t\tfail(res) {\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style lang=\"scss\">\r\n.filter-button-container{\r\n\tposition: absolute;\r\n\tdisplay: flex;\r\n\ttop: 80vh;\r\n\twidth: 100%;\r\n\t\r\n}\t\n.shops-container{\n\tmargin: 5px 10px;\n\t// border-bottom: 1px solid #e2e2e2; /* 设置下边框线为1像素宽的实线 */\n}\n.goods-card{\n\tpadding: 10px;\n}\n.mini-text{\n\tfont-size: 13px;\n\tfont-weight: bold;\n\tfont-family: -webkit-pictograph;\n}\t\n.choice-bar-container{\n\twidth: 100%;\n\tbackground: #1296DB;\n\tdisplay: flex;\n\toverflow : auto;\n\tbackground: white;\n}\n.choice-bar-item-box {\n\theight: 100%;\n\twidth: 100px;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tjustify-content: center;\n\tpadding: 5px 0;\n} \n\n</style>\n","import mod from \"-!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./shops_selling_This_goods.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilder\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./shops_selling_This_goods.vue?vue&type=style&index=0&lang=scss&\""],"sourceRoot":""}
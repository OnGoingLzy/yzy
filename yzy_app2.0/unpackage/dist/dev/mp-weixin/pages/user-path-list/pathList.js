(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user-path-list/pathList"],{234:function(t,e,n){"use strict";(function(t,e){var a=n(4);n(26);a(n(25));var r=a(n(235));t.__webpack_require_UNI_MP_PLUGIN__=n,e(r.default)}).call(this,n(1)["default"],n(2)["createPage"])},235:function(t,e,n){"use strict";n.r(e);var a=n(236),r=n(238);for(var o in r)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return r[t]}))}(o);n(247);var i,s=n(72),u=Object(s["default"])(r["default"],a["render"],a["staticRenderFns"],!1,null,null,null,!1,a["components"],i);u.options.__file="pages/user-path-list/pathList.vue",e["default"]=u.exports},236:function(t,e,n){"use strict";n.r(e);var a=n(237);n.d(e,"render",(function(){return a["render"]})),n.d(e,"staticRenderFns",(function(){return a["staticRenderFns"]})),n.d(e,"recyclableRender",(function(){return a["recyclableRender"]})),n.d(e,"components",(function(){return a["components"]}))},237:function(t,e,n){"use strict";var a;n.r(e),n.d(e,"render",(function(){return r})),n.d(e,"staticRenderFns",(function(){return i})),n.d(e,"recyclableRender",(function(){return o})),n.d(e,"components",(function(){return a}));var r=function(){var t=this,e=t.$createElement;t._self._c},o=!1,i=[];r._withStripped=!0},238:function(t,e,n){"use strict";n.r(e);var a=n(239),r=n.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(o);e["default"]=r.a},239:function(t,e,n){"use strict";(function(t){var a=n(4);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=a(n(30)),o=a(n(32)),i=a(n(240)),s=a(n(33)),u={data:function(){return{list:[],openid:t.getStorageSync("openid")}},components:{addPath:i.default},onShow:function(t){this.getAddressList()},onLoad:function(){},methods:{getAddressList:function(){var e=this;return(0,o.default)(r.default.mark((function n(){var a,o,i,u;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a="/api/user/getAddressList",o="POST",i={openid:t.getStorageSync("openid")},n.prev=3,n.next=6,(0,s.default)("yzy_app",a,o,i);case 6:u=n.sent,console.log(u),99==u.code&&(e.list=u.data.data),n.next=14;break;case 11:n.prev=11,n.t0=n["catch"](3),console.log(n.t0);case 14:case"end":return n.stop()}}),n,null,[[3,11]])})))()},updateAddress:function(e){return(0,o.default)(r.default.mark((function n(){var a;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:a=JSON.stringify({item:e}),t.navigateTo({url:"../user-add-path/addPath?data="+a});case 2:case"end":return n.stop()}}),n)})))()},deleteAddress:function(e){var n=this;return(0,o.default)(r.default.mark((function a(){var o;return r.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:o=n,t.showModal({title:"删除",content:"是否删除该地址",success:function(n){if(n.confirm)o.postDeleteAddress(e),t.showLoading({title:"删除中"});else if(n.cancel)return}});case 2:case"end":return a.stop()}}),a)})))()},postDeleteAddress:function(e){var n=this;return(0,o.default)(r.default.mark((function a(){var o,i,u,c,d;return r.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return o=n.list[e],console.log(n.pathObj),i="/api/user/deleteAddress",u="POST",c={userId:o.userId,id:o.id},a.prev=5,a.next=8,(0,s.default)("yzy_app",i,u,c);case 8:d=a.sent,console.log(d),99==d.code&&(console.log(n.list),t.hideLoading(),t.showToast({title:"删除成功",icon:"success",duration:2e3}),n.getAddressList()),a.next=16;break;case 13:a.prev=13,a.t0=a["catch"](5),console.log(a.t0);case 16:case"end":return a.stop()}}),a,null,[[5,13]])})))()},goAddPath:function(){t.navigateTo({url:"../user-add-path/addPath"})},getWechatAddress:function(){var e=this,n=this;t.showModal({title:"提示",content:"是否使用微信地址？",success:function(a){a.confirm?t.chooseAddress({success:function(t){var a={name:t.userName,tel:t.telNumber,city:t.provinceName+"-"+t.cityName+"-"+t.countyName,details:t.detailInfo,isDefault:0,openid:n.openid};e.$refs.addPath.pathObj=a,e.$refs.addPath.addAddress(),e.getAddressList()}}):t.navigateTo({url:"../user-add-path/addPath"})}})}},onUnload:function(){t.$emit("pageClosedAddress","Success"),console.log("pageClosedAddress: FromPathList")}};e.default=u}).call(this,n(2)["default"])},240:function(t,e,n){"use strict";n.r(e);var a=n(241),r=n(243);for(var o in r)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return r[t]}))}(o);n(245);var i,s=n(72),u=Object(s["default"])(r["default"],a["render"],a["staticRenderFns"],!1,null,"07147041",null,!1,a["components"],i);u.options.__file="pages/user-add-path/addPath.vue",e["default"]=u.exports},241:function(t,e,n){"use strict";n.r(e);var a=n(242);n.d(e,"render",(function(){return a["render"]})),n.d(e,"staticRenderFns",(function(){return a["staticRenderFns"]})),n.d(e,"recyclableRender",(function(){return a["recyclableRender"]})),n.d(e,"components",(function(){return a["components"]}))},242:function(t,e,n){"use strict";var a;n.r(e),n.d(e,"render",(function(){return r})),n.d(e,"staticRenderFns",(function(){return i})),n.d(e,"recyclableRender",(function(){return o})),n.d(e,"components",(function(){return a}));var r=function(){var t=this,e=t.$createElement;t._self._c},o=!1,i=[];r._withStripped=!0},243:function(t,e,n){"use strict";n.r(e);var a=n(244),r=n.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(o);e["default"]=r.a},244:function(t,e,n){"use strict";(function(t,a){var r=n(4);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=r(n(30)),i=r(n(32)),s=r(n(33)),u=function(){Promise.all([n.e("common/vendor"),n.e("components/uni/auto-parse-address/auto-parse-address")]).then(function(){return resolve(n(606))}.bind(null,n)).catch(n.oe)},c=function(){Promise.all([n.e("common/vendor"),n.e("components/uni/mpvue-citypicker/mpvueCityPicker")]).then(function(){return resolve(n(615))}.bind(null,n)).catch(n.oe)},d={props:{list:{type:Array,required:!1}},data:function(){return{longitude:120,latitude:24,currentLocation:null,pickerValueDefault:[0,0,1],pathObj:{name:"",tel:"",city:"",details:"",isDefault:0,openid:t.getStorageSync("openid"),userId:0,id:0,longitude:0,latitude:0},i:-1,isStatus:!1,rules:{name:[{required:!0,message:"请输入姓名",trigger:["blur","change"]}],tel:[{required:!0,message:"请输入手机号",trigger:["blur","change"],type:"number"},{validator:function(t,e,n){0==/^1[34578]\d{9}$/.test(e)?n(new Error("手机号格式错误")):n()},trigger:"blur"}],detail:[{required:!0,message:"请输入详细地址",trigger:["blur","change"]}]}}},onLoad:function(e){if(e.data){t.setNavigationBarTitle({title:"修改地址"});var n=JSON.parse(e.data);this.pathObj=n.item,this.currentLocation={name:this.pathObj.city,address:this.pathObj.details.split(";")[0],longitude:this.pathObj.longitude,latitude:this.pathObj.latitude},this.pathObj.details=this.pathObj.details.split(";")[1],this.isStatus=!0}},components:{"auto-parse-address":u,mpvuePicker:c},onNavigationBarButtonTap:function(){},mounted:function(){},methods:{getUserLocation:function(){console.log("获取位置");var e=this;t.getLocation({type:"gcj02",success:function(t){console.log(t),e.longitude=t.longitude,e.latitude=t.latitude,e.handerChooseLocation(t.latitude,t.longitude)},fail:function(n){t.showModal({title:"授权",content:"需要授权才能获取位置信息",success:function(t){if(t.confirm)e.authVerification();else if(t.cancel)return}})}})},authVerification:function(){var e=this;t.getSetting({success:function(t){t.authSetting["scope.userLocation"]?e.getUserLocation():void 0===t.authSetting["scope.userLocation"]?(console.log("没有授权"),e.handleOpenSetting()):(console.log("拒绝了授权 false"),e.handleOpenSetting())}})},handerChooseLocation:function(e,n){var a=this;console.log(a.latitude+"/"+a.longitude),t.chooseLocation({latitude:a.latitude,longitude:a.longitude,success:function(t){console.log("wx.chooseLocation res=",t),a.currentLocation=t,console.log(a.currentLocation)},fail:function(t){console.log("取消按钮",t)}})},handleOpenSetting:function(){var t=this;a.openSetting({success:function(e){console.log("定位 openSetting",e),e.authSetting["scope.userLocation"]&&t.handerChooseLocation()}})},addOrUpdateAddress:function(){this.validateForm()&&(this.isStatus?this.updateAddress():this.addAddress())},addAddress:function(){var e=this;return(0,i.default)(o.default.mark((function n(){var a,r,i,u;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.currentLocation){n.next=5;break}return t.showToast({title:"请选择收货地址"}),n.abrupt("return");case 5:e.pathObj.city=e.currentLocation.address,e.pathObj.details=e.currentLocation.name+";"+e.pathObj.details,e.pathObj.longitude=e.currentLocation.longitude,e.pathObj.latitude=e.currentLocation.latitude;case 9:return a="/api/user/addAddress",r="POST",i={pathObj:e.pathObj},n.prev=12,n.next=15,(0,s.default)("yzy_app",a,r,i);case 15:u=n.sent,console.log(u),99==u.code?(t.showToast({title:"添加成功",icon:"none"}),t.navigateBack()):t.showToast({title:"添加失败",icon:"none"}),n.next=23;break;case 20:n.prev=20,n.t0=n["catch"](12),console.log(n.t0);case 23:case"end":return n.stop()}}),n,null,[[12,20]])})))()},updateAddress:function(){var e=this;return(0,i.default)(o.default.mark((function n(){var a,r,i,u;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.currentLocation){n.next=5;break}return t.showToast({title:"请选择收货地址"}),n.abrupt("return");case 5:e.pathObj.city=e.currentLocation.address,e.pathObj.details=e.currentLocation.name+";"+e.pathObj.details,e.pathObj.longitude=e.currentLocation.longitude,e.pathObj.latitude=e.currentLocation.latitude;case 9:return a="/api/user/updateAddress",r="POST",i={pathObj:e.pathObj},n.prev=12,n.next=15,(0,s.default)("yzy_app",a,r,i);case 15:u=n.sent,console.log(u),99==u.data.flag?(t.showToast({title:"修改成功",icon:"none"}),t.navigateBack()):t.showToast({title:"添加失败",icon:"none"}),n.next=23;break;case 20:n.prev=20,n.t0=n["catch"](12),console.log(n.t0);case 23:case"end":return n.stop()}}),n,null,[[12,20]])})))()},showPicker:function(){this.$refs.mpvuePicker.show()},onConfirm:function(t){this.pathObj.city=t.label},radioChange:function(){this.pathObj.isDefault=0===this.pathObj.isDefault?1:0},validateForm:function(){if(!this.pathObj.name)return t.showToast({title:"请输入收货人姓名",icon:"none"}),!1;if(!this.pathObj.tel)return t.showToast({title:"请输入手机号码",icon:"none"}),!1;var e=/^[1][3,4,5,7,8,9][0-9]{9}$/;return e.test(this.pathObj.tel)?!!this.pathObj.details||(t.showToast({title:"请输入详细地址",icon:"none"}),!1):(t.showToast({title:"手机号码格式错误",icon:"none"}),!1)},result:function(t){this.pathObj.name=t.name,this.pathObj.tel=t.phone,this.pathObj.city=t.province+"-"+t.area+"-"+t.city,this.pathObj.details=t.detail}}};e.default=d}).call(this,n(2)["default"],n(1)["default"])},245:function(t,e,n){"use strict";n.r(e);var a=n(246),r=n.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(o);e["default"]=r.a},246:function(t,e,n){},247:function(t,e,n){"use strict";n.r(e);var a=n(248),r=n.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(o);e["default"]=r.a},248:function(t,e,n){}},[[234,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/user-path-list/pathList.js.map
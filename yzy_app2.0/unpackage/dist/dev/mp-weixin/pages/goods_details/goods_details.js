(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/goods_details/goods_details"],{210:function(o,e,n){"use strict";(function(o,e){var t=n(4);n(26);t(n(25));var r=t(n(211));o.__webpack_require_UNI_MP_PLUGIN__=n,e(r.default)}).call(this,n(1)["default"],n(2)["createPage"])},211:function(o,e,n){"use strict";n.r(e);var t=n(212),r=n(214);for(var s in r)["default"].indexOf(s)<0&&function(o){n.d(e,o,(function(){return r[o]}))}(s);n(216);var i,a=n(72),c=Object(a["default"])(r["default"],t["render"],t["staticRenderFns"],!1,null,null,null,!1,t["components"],i);c.options.__file="pages/goods_details/goods_details.vue",e["default"]=c.exports},212:function(o,e,n){"use strict";n.r(e);var t=n(213);n.d(e,"render",(function(){return t["render"]})),n.d(e,"staticRenderFns",(function(){return t["staticRenderFns"]})),n.d(e,"recyclableRender",(function(){return t["recyclableRender"]})),n.d(e,"components",(function(){return t["components"]}))},213:function(o,e,n){"use strict";var t;n.r(e),n.d(e,"render",(function(){return r})),n.d(e,"staticRenderFns",(function(){return i})),n.d(e,"recyclableRender",(function(){return s})),n.d(e,"components",(function(){return t}));try{t={uniCollapse:function(){return n.e("uni_modules/uni-collapse/components/uni-collapse/uni-collapse").then(n.bind(null,567))},uniCollapseItem:function(){return n.e("uni_modules/uni-collapse/components/uni-collapse-item/uni-collapse-item").then(n.bind(null,574))},uniGoodsNav:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-goods-nav/components/uni-goods-nav/uni-goods-nav")]).then(n.bind(null,581))},uniPopup:function(){return n.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(n.bind(null,525))},uniIcons:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-icons/components/uni-icons/uni-icons")]).then(n.bind(null,510))}}}catch(a){if(-1===a.message.indexOf("Cannot find module")||-1===a.message.indexOf(".vue"))throw a;console.error(a.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var r=function(){var o=this,e=o.$createElement;o._self._c;o._isMounted||(o.e0=function(){return o.handleImageError(0)},o.e1=function(e){o.indicationShow=!o.indicationShow},o.e2=function(e){var n=[],t=arguments.length-1;while(t-- >0)n[t]=arguments[t+1];var r=n[n.length-1].currentTarget.dataset,s=r.eventParams||r["event-params"];e=s.i;return o.handleImageError(e)},o.e3=function(){return o.handleImageError(0)},o.e4=function(e){o.visible=!1})},s=!1,i=[];r._withStripped=!0},214:function(o,e,n){"use strict";n.r(e);var t=n(215),r=n.n(t);for(var s in t)["default"].indexOf(s)<0&&function(o){n.d(e,o,(function(){return t[o]}))}(s);e["default"]=r.a},215:function(o,e,n){"use strict";(function(o){var t=n(4);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=t(n(30)),s=t(n(32)),i=t(n(33));function a(o,e){var n="undefined"!==typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!n){if(Array.isArray(o)||(n=c(o))||e&&o&&"number"===typeof o.length){n&&(o=n);var t=0,r=function(){};return{s:r,n:function(){return t>=o.length?{done:!0}:{done:!1,value:o[t++]}},e:function(o){throw o},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,i=!0,a=!1;return{s:function(){n=n.call(o)},n:function(){var o=n.next();return i=o.done,o},e:function(o){a=!0,s=o},f:function(){try{i||null==n.return||n.return()}finally{if(a)throw s}}}}function c(o,e){if(o){if("string"===typeof o)return u(o,e);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(o,e):void 0}}function u(o,e){(null==e||e>o.length)&&(e=o.length);for(var n=0,t=new Array(e);n<e;n++)t[n]=o[n];return t}var l=function(){n.e("components/goods/goods_card").then(function(){return resolve(n(539))}.bind(null,n)).catch(n.oe)},d=function(){n.e("components/order/order_popup").then(function(){return resolve(n(592))}.bind(null,n)).catch(n.oe)},p={components:{goodsCard:l,orderPopup:d},data:function(){return{visible:!1,indicationShow:!1,addressList:[],goods:{},shop:{},choiceBar:"test1",imgurl:"http://images.yndzyf.com/getimage.ashx?mlszh=",defaultPic:"http://images.yndzyf.com/getimage.ashx?mlszh=17700932",errorImage:"/static/icon/errorImg.svg",orderType:"",indication:"",UsageAndDosage:"",currentIndex:0,options:[{icon:"shop",text:"店铺",info:0,infoBackgroundColor:"#007aff",infoColor:"#f5f5f5"},{icon:"cart",text:"购物车",info:0}],buttonGroup:[{text:"加入购物车",backgroundColor:"linear-gradient(90deg, #FFCD1E, #FF8A18)",color:"#fff"},{text:"立即购买",backgroundColor:"linear-gradient(90deg, #FE6035, #EF1224)",color:"#fff"}],customButtonGroup1:[{text:"问诊开方",backgroundColor:"linear-gradient(90deg, #FE6035, #EF1224)",color:"#fff"}],shoppingCart:[]}},computed:{theGoodsType:function(){if(this.goods&&this.goods.goodsType){if(this.goods.goodsType.includes("药"))return"药品";if(this.goods.goodsType.includes("械"))return"器械"}}},onLoad:function(o){this.goods=JSON.parse(decodeURIComponent(o.goods)),this.shop=JSON.parse(decodeURIComponent(o.shop)),console.log("111111"),console.log(this.goods),console.log(this.shop),this.getUserCartGoods()},onShow:function(){this.getAddressList()},methods:{openPopup:function(){this.visible=!0},closePopup:function(){this.visible=!1},getUserCartGoods:function(){var e=this;return(0,s.default)(r.default.mark((function n(){var t,s,c,u,l,d,p,f;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t="/api/user/getUserCartGoods",s="POST",c={openid:o.getStorageSync("openid"),phone:o.getStorageSync("phone")},n.prev=3,n.next=6,(0,i.default)("yzy_app",t,s,c);case 6:if(u=n.sent,console.log(u),u.data){e.shoppingCart=JSON.parse(u.data),l=0,d=a(e.shoppingCart);try{for(d.s();!(p=d.n()).done;)f=p.value,l=f.drugs.length+l}catch(r){d.e(r)}finally{d.f()}e.options[1].info=l}n.next=14;break;case 11:n.prev=11,n.t0=n["catch"](3),console.log(n.t0);case 14:case"end":return n.stop()}}),n,null,[[3,11]])})))()},showImg:function(e){console.log(e);o.previewImage({urls:[e],longPressActions:{itemList:["发送给朋友","保存图片","收藏"],success:function(o){},fail:function(o){console.log(o.errMsg)}}})},toAddUserAddress:function(){o.navigateTo({url:"/pages/user-add-path/addPath"})},showNextAddress:function(){this.currentIndex=(this.currentIndex+1)%this.addressList.length},toShop:function(){o.navigateTo({url:"/pages/shop_certificate/shop_certificate?shopName="+encodeURIComponent(JSON.stringify(this.shop.shopName))+"&shopId="+encodeURIComponent(JSON.stringify(this.shop.shopId))+"&shop="+encodeURIComponent(JSON.stringify(this.shop))})},getAddressList:function(){var e=this;return(0,s.default)(r.default.mark((function n(){var t,s,a,c;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t="/api/user/getAddressList",s="POST",a={openid:o.getStorageSync("openid")},n.prev=3,n.next=6,(0,i.default)("yzy_app",t,s,a);case 6:c=n.sent,console.log(c),99==c.code?(e.addressList=c.data.data,console.log(e.list)):console.log("-99"+c.result),n.next=14;break;case 11:n.prev=11,n.t0=n["catch"](3),console.log(n.t0);case 14:case"end":return n.stop()}}),n,null,[[3,11]])})))()},toPrescription:function(){o.navigateTo({url:"/pages/prescription/prescription"})},popupBuyGoods:function(e){o.getStorageSync("phone")?(o.requestSubscribeMessage({tmplIds:["K9QtB4z2B8YIyUScP1Bx5iROO-IOZqd3Opi7KjySbKc","JZGbfSSv0-jB5yS4GObkqD0TUrPqDdAbalAcz70xjZg"],success:function(o){console.log(o)}}),this.orderType=e,this.openPopup(),console.log("弹出")):this.toAuthorizePhone()},closePopupBuyGoods:function(e){var n=this;console.log(e);var t=e.num;"null"==e?(this.$refs.popup.close(),this.closePopup()):"加入购物车"==e.type?(this.addToShoppingCart(e.num),this.$refs.popup.close(),this.closePopup()):"立即购买"==e.type?this.addToShoppingCart(t).then((function(e){var r=[{id:0,shopName:n.shop.shopName,shopId:n.shop.shopId,simplifyShopName:n.shop.simplifyShopName,drugs:[{id:e,drugId:n.goods.goodsId,drugName:n.goods.genericName,specification:n.goods.specification,price:n.shop.price,num:t,imgLszh:n.goods.goodsImg?n.goods.goodsImg[0].tplszh:"",manufacturer:n.goods.manufacturer,sellUnit:n.goods.sellUnit,healthInsuranceFlag:n.shop.healthInsuranceFlag}]}];o.navigateTo({url:"/pages/confirm_order/confirm_order?drug=".concat(encodeURIComponent(JSON.stringify(r)))})})).catch((function(o){console.error("Error:",o)})):(this.$refs.popup.close(),this.closePopup())},addToShoppingCart:function(e){var n=this;return(0,s.default)(r.default.mark((function t(){var s,a,c,u;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s="/api/trade/addGoodsToShoppingCart",a="POST",c={openid:o.getStorageSync("openid"),shopId:n.shop.shopId,goodsId:n.goods.goodsId,num:e},t.prev=3,t.next=6,(0,i.default)("yzy_app",s,a,c);case 6:if(u=t.sent,console.log(u),99!=u.code){t.next=14;break}return n.getUserCartGoods(),o.showToast({icon:"none",title:"商品已加入购物车"}),t.abrupt("return",u.data.shoppingCartId);case 14:o.showToast({icon:"none",title:"添加失败"+u.data.sm});case 15:t.next=21;break;case 17:t.prev=17,t.t0=t["catch"](3),console.log(t.t0),o.showToast({icon:"none",title:"服务器出错了"});case 21:case"end":return t.stop()}}),t,null,[[3,17]])})))()},onClick:function(e){"购物车"==e.content.text?(console.log(e.content.text),o.switchTab({url:"/pages/shopping_cart/shopping_cart"})):this.toShop()},toAuthorizePhone:function(){o.navigateTo({url:"/pages/login/login"})},buttonClick:function(e){o.getStorageSync("phone")?(console.log(e),o.requestSubscribeMessage({tmplIds:["NaEQhsqAO72iO_ruYzrhHIZigJQO8davB0gST5-xtIk","K9QtB4z2B8YIyUScP1Bx5uEk1tudwnuVUXA6SZM3H0E","JZGbfSSv0-jB5yS4GObkqD0TUrPqDdAbalAcz70xjZg"],success:function(o){console.log(o)}}),0==e.index?this.popupBuyGoods("加入购物车"):1==e.index&&this.popupBuyGoods("立即购买")):this.toAuthorizePhone()},selectBar:function(o){this.choiceBar=o,"test2"==o?this.scrollToTarget("2"):this.scrollToTarget("1")},toNewSearch:function(){o.navigateTo({url:"/pages/search/search"})},handleImageError:function(o){console.log("图片加载失败"),this.goods.goodsImg[o].tplszh=this.errorImage},scrollToTarget:function(e){"2"==e?o.pageScrollTo({selector:".goods-detail-container2",duration:300}):o.pageScrollTo({selector:".content",duration:300})}}};e.default=p}).call(this,n(2)["default"])},216:function(o,e,n){"use strict";n.r(e);var t=n(217),r=n.n(t);for(var s in t)["default"].indexOf(s)<0&&function(o){n.d(e,o,(function(){return t[o]}))}(s);e["default"]=r.a},217:function(o,e,n){}},[[210,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/goods_details/goods_details.js.map
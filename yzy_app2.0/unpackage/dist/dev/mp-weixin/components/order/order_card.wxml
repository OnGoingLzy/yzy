<view class="content"><view class="order-list card-shadow"><view class="order-item"><view class="item-list"><view class="shop-name"><view data-event-opts="{{[['tap',[['toShop',['$event']]]]]}}" style="width:70%;display:flex;align-items:center;" bindtap="__e"><image style="width:18px;height:18px;" src="/static/icon/药店.svg"></image>{{''+order.shopInfo[0].simplifyShopName+''}}</view><view style="display:flex;justify-content:flex-end;width:30%;padding-right:10px;"><text style="font-weight:100;color:gray;">{{order.status=='已取消'?'退款已取消':order.status}}</text></view></view><block wx:for="{{order.goodsList}}" wx:for-item="item" wx:for-index="j" wx:key="j"><view class="item"><view data-event-opts="{{[['tap',[['toPurchasedGoodsDetails',['$0'],[[['order.goodsList','',j]]]]]]]}}" class="item-info" bindtap="__e"><image style="border-radius:8px;" src="{{item.goodsImg[0].tplszh?'http://images.yndzyf.com/getimage.ashx?mlszh='+item.goodsImg[0].tplszh:defaultPic}}" mode></image><view class="item-details"><view class="item-name">{{item.genericName}}</view><view class="item-spec">{{item.specification}}</view><view class="item-spec">{{item.manufacturer}}</view></view><view class="item-detail-right"><view class="item-quantity">{{"x"+item.num}}</view><view class="item-price">{{"￥"+item.unitPrice}}</view></view></view></view></block><block wx:if="{{order.status=='待付款'&&order.cash_url=='无'}}"><view style="padding-right:14px;display:flex;justify-content:flex-end;"><button class="mini-btn" style="margin:initial;border-radius:50px;" type="primary" size="mini" data-event-opts="{{[['tap',[['testExistsPrePayOrderWxPay',['$event']]]]]}}" bindtap="__e">付款</button></view></block><block wx:if="{{order.status=='待付款'&&order.cash_url!=='无'}}"><view style="padding-right:14px;display:flex;justify-content:flex-end;"><button class="mini-btn" style="margin:initial;border-radius:50px;" type="primary" size="mini" data-event-opts="{{[['tap',[['OpenYhPay',['$event']]]]]}}" bindtap="__e">付款</button></view></block><block wx:if="{{order.status=='退款中'&&order.cash_url!=='无'}}"><view style="padding-right:14px;display:flex;justify-content:flex-end;"><button class="mini-btn" style="margin:initial;border-radius:50px;" type="primary" size="mini" data-event-opts="{{[['tap',[['OpenRefund',['$0'],['order.main_order_id']]]]]}}" bindtap="__e">获取退款金额</button></view></block><block wx:if="{{order.status=='待发货'||order.status=='待收货'}}"><view style="padding-right:14px;display:flex;justify-content:flex-end;"><button class="mini-btn" style="margin:initial;border-radius:50px;" type="warn" size="mini" data-event-opts="{{[['tap',[['refund',['$event']]]]]}}" bindtap="__e">退款</button><block wx:if="{{order.status=='待收货'}}"><button class="mini-btn" style="margin:initial;margin-left:10px;border-radius:50px;" type="primary" size="mini" data-event-opts="{{[['tap',[['confirmReceived',['$event']]]]]}}" bindtap="__e">确认收货</button></block></view></block><view class="line" style="margin-top:5px;"></view><view class="form-container"><block wx:if="{{order.cash_url!=='无'}}"><view class="form-item"><view class="label"></view><view class="value"><text class="label-word" style="color:#ff4006;">医保支付</text></view></view></block><view class="form-item"><view class="label"><text class="label-word">订单号：</text></view><view class="value"><text user-select="true">{{''+order.main_order_id}}</text></view></view><view class="form-item"><view class="label"><text class="label-word">送至：</text></view><view class="value">{{order.goodsList[0].address}}</view></view><view class="form-item"><view class="label"><text class="label-word">运费：</text></view><view class="value"><text style="color:#ff4006;">{{'￥'+order.shippingFee}}</text></view></view><view class="form-item"><view class="label"><text class="label-word">总价：</text></view><view class="value"><text style="font-size:16px;font-weight:bold;color:#ff4006;">{{'￥'+order.totalPrice}}</text></view></view><block wx:if="{{order.status=='已取消'||order.outerReturnedResult!='NO'}}"><view class="form-item"><view class="value"><text style="font-size:13px;font-weight:bold;color:#d60f00;">{{order.outerReturnedResult=='NO'?'不符合退货/款标准,请咨询药房获取详细原因':order.outerReturnedResult}}</text></view></view></block><view hidden="{{!(showMore)}}" class="collapse-box"><view class="form-item"><view class="label"><text class="label-word">商品数量：</text></view><view class="value">{{'共 '+order.totalNum+' 件'}}</view></view><view data-event-opts="{{[['tap',[['callPhone',['$0'],['order.shopInfo.__$n0.shopPhone']]]]]}}" class="form-item" bindtap="__e"><view class="label"><text class="label-word">发票信息：</text></view><view class="value"><text>请联系药房:</text><text style="color:#0055ff;">{{order.shopInfo[0].shopPhone}}</text></view></view><view class="form-item"><view class="label"><text class="label-word">创建时间：</text></view><view class="value">{{order.createTime}}</view></view><block wx:if="{{order.payTime!='NO'&&order.payTime!=null}}"><view class="form-item"><view class="label"><text class="label-word">支付时间：</text></view><view class="value">{{order.payTime}}</view></view></block><block wx:if="{{order.deliveryTime!='NO'}}"><view class="form-item"><view class="label"><text class="label-word">发货时间：</text></view><view class="value">{{order.deliveryTime}}</view></view></block><block wx:if="{{order.receivedTime!='NO'}}"><view class="form-item"><view class="label"><text class="label-word">收货时间：</text></view><view class="value">{{order.receivedTime}}</view></view></block><block wx:if="{{order.refundTime!='NO'&&order.refundTime!=null}}"><view class="form-item"><view class="label"><text class="label-word">退款时间：</text></view><view class="value">{{order.refundTime}}</view></view></block><block wx:if="{{order.shippingType!=''&&order.shippingType!=null}}"><view class="form-item"><view class="label"><text class="label-word">配送方式：</text></view><view class="shipping-type-btn">{{order.shippingType}}</view></view></block><block wx:if="{{order.memo!=''}}"><view class="form-item" style="display:block;"><view class="label"><text class="label-word">订单备注：</text></view><view style="background:#ececec;color:#999;padding:5px;border-radius:10px;">{{order.memo}}</view></view></block></view></view><block wx:if="{{order.status=='已过期'}}"><view style="margin-right:15px;display:flex;justify-content:flex-end;"><text style="font-size:16px;color:gray;">已过期</text></view></block><view data-event-opts="{{[['tap',[['clickShowMore']]]]}}" style="display:flex;justify-content:center;" bindtap="__e"><text style="color:gray;">{{showMore?'收起':'查看更多'}}</text></view></view></view></view><uni-popup class="vue-ref" vue-id="0f7f15a9-1" type="center" mask-click="{{isEnableClick}}" animation="{{false}}" mask="{{true}}" data-ref="popup" bind:__l="__l" vue-slots="{{['default']}}"><view class="popup"><view class="popup-content"><view class="popup-title">申请退款</view><view class="popup-reason"><view>请选择退款原因：</view><uni-data-select bind:input="__e" style="width:325rpx;" vue-id="{{('0f7f15a9-2')+','+('0f7f15a9-1')}}" localdata="{{checkboxRange}}" clear="{{false}}" value="{{checkboxValue}}" data-event-opts="{{[['^input',[['__set_model',['','checkboxValue','$event',[]]]]]]}}" bind:__l="__l"></uni-data-select></view><view class="uni-textarea textarea"><textarea placeholder="请输入申请退货原因(选填)" data-event-opts="{{[['input',[['__set_model',['','textareaContent','$event',[]]]]]]}}" value="{{textareaContent}}" bindinput="__e"></textarea></view><view class="button-list"><button class="mini-btn confirm-refund" style="margin:0rpx 40rpx;" type="primary" size="mini" data-event-opts="{{[['tap',[['refundConfirm',['$event']]]]]}}" bindtap="__e">确认</button><button class="mini-btn" style="margin:0rpx 40rpx;" type="default" size="mini" data-event-opts="{{[['tap',[['refundCancel',['$event']]]]]}}" bindtap="__e">取消</button></view></view></view></uni-popup></view>
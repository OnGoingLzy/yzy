;my.defineComponent || (my.defineComponent = Component);(my["webpackJsonp"]=my["webpackJsonp"]||[]).push([["components/order/order_popup"],{588:function(e,o,t){"use strict";t.r(o);var n=t(589),i=t(591);for(var r in i)["default"].indexOf(r)<0&&function(e){t.d(o,e,(function(){return i[e]}))}(r);t(593);var s,c=t(68),u=Object(c["default"])(i["default"],n["render"],n["staticRenderFns"],!1,null,null,null,!1,n["components"],s);u.options.__file="components/order/order_popup.vue",o["default"]=u.exports},589:function(e,o,t){"use strict";t.r(o);var n=t(590);t.d(o,"render",(function(){return n["render"]})),t.d(o,"staticRenderFns",(function(){return n["staticRenderFns"]})),t.d(o,"recyclableRender",(function(){return n["recyclableRender"]})),t.d(o,"components",(function(){return n["components"]}))},590:function(e,o,t){"use strict";var n;t.r(o),t.d(o,"render",(function(){return i})),t.d(o,"staticRenderFns",(function(){return s})),t.d(o,"recyclableRender",(function(){return r})),t.d(o,"components",(function(){return n}));try{n={uniNumberBox:function(){return t.e("uni_modules/uni-number-box/components/uni-number-box/uni-number-box").then(t.bind(null,621))}}}catch(c){if(-1===c.message.indexOf("Cannot find module")||-1===c.message.indexOf(".vue"))throw c;console.error(c.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var i=function(){var e=this,o=e.$createElement;e._self._c},r=!1,s=[];i._withStripped=!0},591:function(e,o,t){"use strict";t.r(o);var n=t(592),i=t.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){t.d(o,e,(function(){return n[e]}))}(r);o["default"]=i.a},592:function(e,o,t){"use strict";(function(e){var n=t(3);Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i=n(t(26)),r=n(t(28)),s=n(t(29)),c=function(){t.e("components/goods/goods_card").then(function(){return resolve(t(535))}.bind(null,t)).catch(t.oe)},u={components:{goodsCard:c},name:"orderPopup",props:{shop:{type:Object,default:{}},goods:{type:Object,default:{}},orderType:{}},data:function(){return{num:1,localOrderType:"",recipeId:""}},watch:{orderType:{immediate:!0,deep:!0,handler:function(e){this.localOrderType=e}}},computed:{maxBuyNum:function(){return this.shop.limitNum>0?this.shop.inventory<this.shop.limitNum?this.shop.inventory:this.shop.limitNum:this.shop.inventory}},methods:{existsEffectiveRecipe:function(){var o=this;return(0,r.default)(i.default.mark((function t(){var n,r,c,u,d;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=o,"处方药"!=o.goods.goodsType){t.next=16;break}return r="/api/recipe/existsEffectiveRecipe",c="POST",u={openid:e.getStorageSync("openid"),goodsId:o.goods.goodsId,num:o.num},t.prev=5,t.next=8,(0,s.default)("yzy_app",r,c,u);case 8:d=t.sent,console.log(d),99==d.code&&("true"==d.data.data?(o.recipeId=d.data.recipeId,e.showModal({title:"注意",content:"您已存在一个可用处方,是否直接购买药品？",success:function(e){if(e.confirm)n.toBuyGoods();else if(e.cancel)return}})):o.toPrescription()),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](5),console.log(t.t0);case 16:case"end":return t.stop()}}),t,null,[[5,13]])})))()},toBuyGoods:function(){var o=[{id:0,shopName:this.shop.shopName,shopId:this.shop.shopId,simplifyShopName:this.shop.simplifyShopName,drugs:[{id:this.recipeId,drugId:this.goods.goodsId,drugName:this.goods.genericName,specification:this.goods.specification,price:this.shop.price,num:this.num,imgLszh:this.goods.goodsImg[0].tplszh,manufacturer:this.goods.manufacturer,sellUnit:this.goods.sellUnit}]}];e.navigateTo({url:"/pages/confirm_order/confirm_order?drug=".concat(encodeURIComponent(JSON.stringify(o)))})},numChange:function(e){this.num=e},submit:function(){var o={num:this.num,type:this.localOrderType};if(null!=this.shop.price&&0!=this.shop.price)if("问诊开方"==this.orderType){if(null==this.shop.inventory||0==this.shop.inventory)return void e.showToast({icon:"error",title:"库存不足"});this.existsEffectiveRecipe()}else{if(null==this.shop.inventory||0==this.shop.inventory)return void e.showToast({icon:"error",title:"库存不足"});this.$emit("closePopupBuyGoods",o)}else e.showToast({icon:"error",title:"暂无定价"})},toPrescription:function(){console.log(this.goods.goodsId),e.navigateTo({url:"/pages/consultation/consultation?goodsId=".concat(this.goods.goodsId,"&shopId=").concat(this.shop.shopId,"&goodsAmount=").concat(this.num,"&stockLimit=").concat(this.shop.limitNum,"&stock=").concat(this.shop.inventory)})}}};o.default=u}).call(this,t(1)["default"])},593:function(e,o,t){"use strict";t.r(o);var n=t(594),i=t.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){t.d(o,e,(function(){return n[e]}))}(r);o["default"]=i.a},594:function(e,o,t){}}]);
;(my["webpackJsonp"] = my["webpackJsonp"] || []).push([
    'components/order/order_popup-create-component',
    {
        'components/order/order_popup-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('1')['createComponent'](__webpack_require__(588))
        })
    },
    [['components/order/order_popup-create-component']]
]);

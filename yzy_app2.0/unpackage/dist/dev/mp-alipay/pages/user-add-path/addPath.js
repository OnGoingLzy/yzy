(my["webpackJsonp"]=my["webpackJsonp"]||[]).push([["pages/user-add-path/addPath"],{236:function(t,e,n){"use strict";n.r(e);var a=n(237),i=n(239);for(var o in i)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(o);n(241);var r,s=n(68),c=Object(s["default"])(i["default"],a["render"],a["staticRenderFns"],!1,null,"07147041",null,!1,a["components"],r);c.options.__file="pages/user-add-path/addPath.vue",e["default"]=c.exports},237:function(t,e,n){"use strict";n.r(e);var a=n(238);n.d(e,"render",(function(){return a["render"]})),n.d(e,"staticRenderFns",(function(){return a["staticRenderFns"]})),n.d(e,"recyclableRender",(function(){return a["recyclableRender"]})),n.d(e,"components",(function(){return a["components"]}))},238:function(t,e,n){"use strict";var a;n.r(e),n.d(e,"render",(function(){return i})),n.d(e,"staticRenderFns",(function(){return r})),n.d(e,"recyclableRender",(function(){return o})),n.d(e,"components",(function(){return a}));var i=function(){var t=this,e=t.$createElement;t._self._c},o=!1,r=[];i._withStripped=!0},239:function(t,e,n){"use strict";n.r(e);var a=n(240),i=n.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(o);e["default"]=i.a},240:function(t,e,n){"use strict";(function(t,a){var i=n(3);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(26)),r=i(n(28)),s=i(n(29)),c=function(){Promise.all([n.e("common/vendor"),n.e("components/uni/auto-parse-address/auto-parse-address")]).then(function(){return resolve(n(602))}.bind(null,n)).catch(n.oe)},u=function(){Promise.all([n.e("common/vendor"),n.e("components/uni/mpvue-citypicker/mpvueCityPicker")]).then(function(){return resolve(n(611))}.bind(null,n)).catch(n.oe)},d={props:{list:{type:Array,required:!1}},data:function(){return{longitude:120,latitude:24,currentLocation:null,pickerValueDefault:[0,0,1],pathObj:{name:"",tel:"",city:"",details:"",isDefault:0,openid:t.getStorageSync("openid"),userId:0,id:0,longitude:0,latitude:0},i:-1,isStatus:!1,rules:{name:[{required:!0,message:"请输入姓名",trigger:["blur","change"]}],tel:[{required:!0,message:"请输入手机号",trigger:["blur","change"],type:"number"},{validator:function(t,e,n){0==/^1[34578]\d{9}$/.test(e)?n(new Error("手机号格式错误")):n()},trigger:"blur"}],detail:[{required:!0,message:"请输入详细地址",trigger:["blur","change"]}]}}},onLoad:function(e){if(e.data){t.setNavigationBarTitle({title:"修改地址"});var n=JSON.parse(e.data);this.pathObj=n.item,this.currentLocation={name:this.pathObj.city,address:this.pathObj.details.split(";")[0],longitude:this.pathObj.longitude,latitude:this.pathObj.latitude},this.pathObj.details=this.pathObj.details.split(";")[1],this.isStatus=!0}},components:{"auto-parse-address":c,mpvuePicker:u},onNavigationBarButtonTap:function(){},mounted:function(){},methods:{getUserLocation:function(){console.log("获取位置");var e=this;t.getLocation({type:"gcj02",success:function(t){console.log(t),e.longitude=t.longitude,e.latitude=t.latitude,e.handerChooseLocation(t.latitude,t.longitude)},fail:function(n){t.showModal({title:"授权",content:"需要授权才能获取位置信息",success:function(t){if(t.confirm)e.authVerification();else if(t.cancel)return}})}})},authVerification:function(){var e=this;t.getSetting({success:function(t){t.authSetting["scope.userLocation"]?e.getUserLocation():void 0===t.authSetting["scope.userLocation"]?(console.log("没有授权"),e.handleOpenSetting()):(console.log("拒绝了授权 false"),e.handleOpenSetting())}})},handerChooseLocation:function(e,n){var a=this;console.log(a.latitude+"/"+a.longitude),t.chooseLocation({latitude:a.latitude,longitude:a.longitude,success:function(t){console.log("wx.chooseLocation res=",t),a.currentLocation=t,console.log(a.currentLocation)},fail:function(t){console.log("取消按钮",t)}})},handleOpenSetting:function(){var t=this;a.openSetting({success:function(e){console.log("定位 openSetting",e),e.authSetting["scope.userLocation"]&&t.handerChooseLocation()}})},addOrUpdateAddress:function(){this.validateForm()&&(this.isStatus?this.updateAddress():this.addAddress())},addAddress:function(){var e=this;return(0,r.default)(o.default.mark((function n(){var a,i,r,c;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.currentLocation){n.next=5;break}return t.showToast({title:"请选择收货地址"}),n.abrupt("return");case 5:e.pathObj.city=e.currentLocation.address,e.pathObj.details=e.currentLocation.name+";"+e.pathObj.details,e.pathObj.longitude=e.currentLocation.longitude,e.pathObj.latitude=e.currentLocation.latitude;case 9:return a="/api/user/addAddress",i="POST",r={pathObj:e.pathObj},n.prev=12,n.next=15,(0,s.default)("yzy_app",a,i,r);case 15:c=n.sent,console.log(c),99==c.code?(t.showToast({title:"添加成功",icon:"none"}),t.navigateBack()):t.showToast({title:"添加失败",icon:"none"}),n.next=23;break;case 20:n.prev=20,n.t0=n["catch"](12),console.log(n.t0);case 23:case"end":return n.stop()}}),n,null,[[12,20]])})))()},updateAddress:function(){var e=this;return(0,r.default)(o.default.mark((function n(){var a,i,r,c;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.currentLocation){n.next=5;break}return t.showToast({title:"请选择收货地址"}),n.abrupt("return");case 5:e.pathObj.city=e.currentLocation.address,e.pathObj.details=e.currentLocation.name+";"+e.pathObj.details,e.pathObj.longitude=e.currentLocation.longitude,e.pathObj.latitude=e.currentLocation.latitude;case 9:return a="/api/user/updateAddress",i="POST",r={pathObj:e.pathObj},n.prev=12,n.next=15,(0,s.default)("yzy_app",a,i,r);case 15:c=n.sent,console.log(c),99==c.data.flag?(t.showToast({title:"修改成功",icon:"none"}),t.navigateBack()):t.showToast({title:"添加失败",icon:"none"}),n.next=23;break;case 20:n.prev=20,n.t0=n["catch"](12),console.log(n.t0);case 23:case"end":return n.stop()}}),n,null,[[12,20]])})))()},showPicker:function(){this.$refs.mpvuePicker.show()},onConfirm:function(t){this.pathObj.city=t.label},radioChange:function(){this.pathObj.isDefault=0===this.pathObj.isDefault?1:0},validateForm:function(){if(!this.pathObj.name)return t.showToast({title:"请输入收货人姓名",icon:"none"}),!1;if(!this.pathObj.tel)return t.showToast({title:"请输入手机号码",icon:"none"}),!1;var e=/^[1][3,4,5,7,8,9][0-9]{9}$/;return e.test(this.pathObj.tel)?!!this.pathObj.details||(t.showToast({title:"请输入详细地址",icon:"none"}),!1):(t.showToast({title:"手机号码格式错误",icon:"none"}),!1)},result:function(t){this.pathObj.name=t.name,this.pathObj.tel=t.phone,this.pathObj.city=t.province+"-"+t.area+"-"+t.city,this.pathObj.details=t.detail}}};e.default=d}).call(this,n(1)["default"],n(1)["default"])},241:function(t,e,n){"use strict";n.r(e);var a=n(242),i=n.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(o);e["default"]=i.a},242:function(t,e,n){},245:function(t,e,n){"use strict";(function(t){var e=n(3);n(22);e(n(21));var a=e(n(236));my.__webpack_require_UNI_MP_PLUGIN__=n,t(a.default)}).call(this,n(1)["createPage"])}},[[245,"common/runtime","common/vendor"]]]);